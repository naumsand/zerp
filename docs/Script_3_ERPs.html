<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
    
    <title>ERP measures</title>
    <!-- Material Design fonts -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">

        <script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
        <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <script src="site_libs/navigation-1.1/codefolding.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/bootstrap_material-0.1/bootstrap-material-design.min.css" rel="stylesheet" />
        <link href="site_libs/bootstrap_material-0.1/ripples.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap_material-0.1/material.min.js"></script>
        <script src="site_libs/bootstrap_material-0.1/ripples.min.js"></script>
        <link href="site_libs/material-0.1/material.css" rel="stylesheet" />
        <script src="site_libs/material-0.1/material.js"></script>
        <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
        <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
        <link rel="stylesheet" href="web_style.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
        <script>
      $(document).ready(function () {
	  	  	  window.initializeCodeFolding("hide" === "show");
	        });
    </script>
    
    <!-- code download -->
    

    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .pages .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .pages .tabset-dropdown > .nav-tabs > li.active > a {
	  background-color: transparent !important;
	  color: #000000 !important;
      }
      
      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
	  color: #00A698 !important;
	  font-weight: 300 !important;
	  font-size: 14px;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
      }
    </style>
    
</head>

<body>

  <div class="header-panel shadow z-2">
    <div class="container-fluid">
      <div class="row">
        <div class="col-xs-3">
	  	  <div id="header">
	    <h1 class="title">ERP measures</h1>
	    	    	    	  </div>
	  	</div>
      </div>
    </div>
  </div>
  
  <div class="container-fluid main-container">
    <div class="row">

<nav class="col-xs-3 menu">
<div id="toc">
<ul>
<li><a href="#eeg-processing">EEG processing</a></li>
<li><a href="#erp-measures">ERP measures</a></li>
</ul>
</div>
</nav>
      
<div class="pages col-xs-9">

        
<div class="row">

<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naumann et al.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-info-sign"></span>
     
    Introduction
  </a>
</li>
<li>
  <a href="Script_1_Sampl_Descr.html">
    <span class="glyphicon glyphicon glyphicon glyphicon-education"></span>
     
    Sample description
  </a>
</li>
<li>
  <a href="Script_2_Report_Measures.html">
    <span class="glyphicon glyphicon-hand-up"></span>
     
    Child-/Parental measures
  </a>
</li>
<li>
  <a href="Script_3_ERPs.html">
    <span class="glyphicon glyphicon-user"></span>
     
    ERPs
  </a>
</li>
<li>
  <a href="Script_4_Brain_Behavior.html">
    <span class="glyphicon glyphicon-resize-small"></span>
     
    Correlational analysis
  </a>
</li>
<li>
  <a href="Script_5_Supplement.html">
    <span class="glyphicon glyphicon glyphicon glyphicon-piggy-bank"></span>
     
    Supplement
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://osf.io/vzgtb/">
    <span class="ai ai ai ai-osf ai-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:sandra.naumann@hu-berlin.de">
    <span class="fas fa-envelope fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">
</div>

    
<div class="row">

<div class="col-xs-10">
<!-- Set up workspace -->
<div id="eeg-processing" class="section level1">
<h1>EEG processing</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>trial_count =<span class="st"> </span><span class="kw">gather</span>(qn_data, trial, count, hap_trials<span class="op">:</span>neu_trials, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>trial_count =<span class="st"> </span><span class="kw">subset</span>(trial_count, <span class="dt">select =</span> <span class="kw">c</span>(trial, count))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="co"># Calculate one-way ANOVA to test equality of trial numbers</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a>trial.aov =<span class="st"> </span><span class="kw">aov</span>(count <span class="op">~</span><span class="st"> </span>trial, <span class="dt">data =</span> trial_count)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a><span class="co"># Extract values to present</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a>trial.aov.sum =<span class="st"> </span><span class="kw">summary</span>(trial.aov)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a>trial.aov.sum =<span class="st"> </span><span class="kw">data.frame</span>(trial.aov.sum[[<span class="dv">1</span>]])</span></code></pre></div>
<ul>
<li>We detected no difference between number of trials per emotion condition: <em>F</em> (2, 177) = 0.01, <em>p</em> = 0.993).</li>
<li>Participants provided an average of:
<ul>
<li>Happy trials: <em>M</em> = 49.02; <em>SD</em> = 10.12</li>
<li>Angry trials: <em>M</em> = 49.23; <em>SD</em> = 10.27 and</li>
<li>Neutral trials: <em>M</em> = 49.08; <em>SD</em> = 9.58.</li>
</ul></li>
</ul>
</div>
<div id="erp-measures" class="section level1">
<h1>ERP measures</h1>
<p>For the analysis of the P1, N170 and P3 at T2, we computed separate analyses of variance (ANOVAs) with ERP amplitude as dependent variable, training as between factor, and facial expressions (happy vs. angry vs. neutral) as within factor.</p>
<p>ERP trajectories and associated topographies are displayed here:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="co"># Topoplots P1 - Emotion effects</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>ga_topo_long =<span class="st"> </span><span class="kw">gather</span>(ga_emo_wide, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="co"># Rename A1/A2</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="kw">names</span>(ga_topo_long)[<span class="kw">names</span>(ga_topo_long) <span class="op">==</span><span class="st"> &quot;A1&quot;</span>] =<span class="st"> &quot;TP9&quot;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a><span class="kw">names</span>(ga_topo_long)[<span class="kw">names</span>(ga_topo_long) <span class="op">==</span><span class="st"> &quot;A2&quot;</span>] =<span class="st"> &quot;TP10&quot;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a><span class="co"># Plot topoplots for happy</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a>Topo_Emo_Hap =<span class="st"> </span><span class="kw">subset</span>(ga_topo_long, emo <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a><span class="co"># Plot topoplots for neutral</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a>Topo_Emo_Neu =<span class="st"> </span><span class="kw">subset</span>(ga_topo_long, emo <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a><span class="co"># Plot topoplots for angry</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a>Topo_Emo_Ang =<span class="st"> </span><span class="kw">subset</span>(ga_topo_long, emo <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true"></a><span class="co"># Calculate difference score angry-neutral</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true"></a>Topo_Diff_Ang_Neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> Topo_Emo_Hap[, <span class="dv">1</span>], <span class="dt">electrode =</span> Topo_Emo_Hap[, </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">amplitude =</span> Topo_Emo_Ang<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Emo_Neu<span class="op">$</span>amplitude)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true"></a><span class="co"># Calculate difference score happy-neutral</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true"></a>Topo_Diff_Hap_Neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> Topo_Emo_Hap[, <span class="dv">1</span>], <span class="dt">electrode =</span> Topo_Emo_Hap[, </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">amplitude =</span> Topo_Emo_Hap<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Emo_Neu<span class="op">$</span>amplitude)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true"></a><span class="co"># Calculate difference score happy-angry</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true"></a>Topo_Diff_Hap_Ang =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> Topo_Emo_Hap[, <span class="dv">1</span>], <span class="dt">electrode =</span> Topo_Emo_Hap[, </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">amplitude =</span> Topo_Emo_Hap<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Emo_Ang<span class="op">$</span>amplitude)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true"></a><span class="co">## P1s</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true"></a>Topo_Diff_Ang_Neu_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Ang_Neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">130</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true"></a>Topo_Diff_Hap_Neu_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Hap_Neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">130</span>)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true"></a>Topo_Diff_Hap_Ang_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Hap_Ang, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">130</span>)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true"></a><span class="co"># Add electrode information</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true"></a>Topo_Diff_Ang_Neu_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Ang_Neu_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true"></a>Topo_Diff_Hap_Neu_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Hap_Neu_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true"></a>Topo_Diff_Hap_Ang_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Hap_Ang_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true"></a><span class="co"># Draw topographies</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true"></a>topo_diff_ang_neu_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Ang_Neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;angry – neutral&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">2.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true"></a></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true"></a></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true"></a><span class="co"># Draw topographies</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true"></a>topo_diff_hap_neu_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Hap_Neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;  happy – neutral&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">2.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true"></a></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true"></a></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true"></a><span class="co"># Draw topographies</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true"></a>topo_diff_hap_ang_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Hap_Ang_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;  happy – angry&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">2.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true"></a></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true"></a></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true"></a><span class="co"># Display plots</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true"></a>fig_topo_P1_emo =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(topo_diff_hap_neu_P1, topo_diff_ang_neu_P1, </span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true"></a>    topo_diff_hap_ang_P1, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true"></a></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true"></a><span class="co">############ </span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true"></a></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true"></a><span class="co"># Topoplots P3 - Group x Emotion effects</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true"></a></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true"></a><span class="co"># Control group</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true"></a>ga_topo_long_cg =<span class="st"> </span><span class="kw">gather</span>(topo_emo_cg, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true"></a></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true"></a><span class="co"># Rename A1/A2</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true"></a><span class="kw">names</span>(ga_topo_long_cg)[<span class="kw">names</span>(ga_topo_long_cg) <span class="op">==</span><span class="st"> &quot;A1&quot;</span>] =<span class="st"> &quot;TP9&quot;</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true"></a><span class="kw">names</span>(ga_topo_long_cg)[<span class="kw">names</span>(ga_topo_long_cg) <span class="op">==</span><span class="st"> &quot;A2&quot;</span>] =<span class="st"> &quot;TP10&quot;</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true"></a></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true"></a><span class="co"># Plot topoplots for happy</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true"></a>Topo_Emo_Hap_CG =<span class="st"> </span><span class="kw">subset</span>(ga_topo_long_cg, emo <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true"></a></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true"></a><span class="co"># Plot topoplots for neutral</span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true"></a>Topo_Emo_Neu_CG =<span class="st"> </span><span class="kw">subset</span>(ga_topo_long_cg, emo <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true"></a></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true"></a><span class="co"># Plot topoplots for angry</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true"></a>Topo_Emo_Ang_CG =<span class="st"> </span><span class="kw">subset</span>(ga_topo_long_cg, emo <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true"></a></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true"></a><span class="co"># Calculate difference score angry-neutral</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true"></a>Topo_Diff_Ang_Neu_CG =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> Topo_Emo_Hap_CG[, <span class="dv">1</span>], <span class="dt">electrode =</span> Topo_Emo_Hap_CG[, </span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">amplitude =</span> Topo_Emo_Ang_CG<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Emo_Neu_CG<span class="op">$</span>amplitude)</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true"></a></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true"></a></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true"></a><span class="co"># Calculate difference score happy-neutral</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true"></a>Topo_Diff_Hap_Neu_CG =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> Topo_Emo_Hap_CG[, <span class="dv">1</span>], <span class="dt">electrode =</span> Topo_Emo_Hap_CG[, </span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">amplitude =</span> Topo_Emo_Hap_CG<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Emo_Neu_CG<span class="op">$</span>amplitude)</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true"></a></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true"></a></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true"></a><span class="co"># Calculate difference score happy-angry</span></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true"></a>Topo_Diff_Hap_Ang_CG =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> Topo_Emo_Hap_CG[, <span class="dv">1</span>], <span class="dt">electrode =</span> Topo_Emo_Hap_CG[, </span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">amplitude =</span> Topo_Emo_Hap_CG<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Emo_Ang_CG<span class="op">$</span>amplitude)</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true"></a></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true"></a>Topo_Diff_Ang_Neu_CG_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Ang_Neu_CG, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">500</span>)</span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true"></a>Topo_Diff_Hap_Neu_CG_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Hap_Neu_CG, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">500</span>)</span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true"></a>Topo_Diff_Hap_Ang_CG_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Hap_Ang_CG, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">500</span>)</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true"></a></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true"></a><span class="co"># Add electrode information</span></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true"></a>Topo_Diff_Ang_Neu_CG_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Ang_Neu_CG_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true"></a>Topo_Diff_Hap_Neu_CG_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Hap_Neu_CG_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true"></a>Topo_Diff_Hap_Ang_CG_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Hap_Ang_CG_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true"></a></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true"></a><span class="co"># Draw topographies</span></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true"></a>Topo_Diff_Ang_Neu_CG_P3_plot =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Ang_Neu_CG_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, </span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true"></a>    <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;angry – neutral&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">3.5</span>, <span class="fl">2.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true"></a></span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true"></a></span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true"></a><span class="co"># Draw topographies</span></span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true"></a>Topo_Diff_Hap_Neu_CG_P3_plot =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Hap_Neu_CG_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, </span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true"></a>    <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;  happy – neutral&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">3.5</span>, <span class="fl">2.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true"></a></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true"></a></span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true"></a><span class="co"># Training group</span></span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true"></a>ga_topo_long_tg =<span class="st"> </span><span class="kw">gather</span>(topo_emo_tg, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true"></a></span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true"></a><span class="co"># Rename A1/A2</span></span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true"></a><span class="kw">names</span>(ga_topo_long_tg)[<span class="kw">names</span>(ga_topo_long_tg) <span class="op">==</span><span class="st"> &quot;A1&quot;</span>] =<span class="st"> &quot;TP9&quot;</span></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true"></a><span class="kw">names</span>(ga_topo_long_tg)[<span class="kw">names</span>(ga_topo_long_tg) <span class="op">==</span><span class="st"> &quot;A2&quot;</span>] =<span class="st"> &quot;TP10&quot;</span></span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true"></a></span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true"></a><span class="co"># Plot topoplots for happy</span></span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true"></a>Topo_Emo_Hap_TG =<span class="st"> </span><span class="kw">subset</span>(ga_topo_long_tg, emo <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true"></a></span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true"></a><span class="co"># Plot topoplots for neutral</span></span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true"></a>Topo_Emo_Neu_TG =<span class="st"> </span><span class="kw">subset</span>(ga_topo_long_tg, emo <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true"></a></span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true"></a><span class="co"># Plot topoplots for angry</span></span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true"></a>Topo_Emo_Ang_TG =<span class="st"> </span><span class="kw">subset</span>(ga_topo_long_tg, emo <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true"></a></span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true"></a><span class="co"># Calculate difference score angry-neutral</span></span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true"></a>Topo_Diff_Ang_Neu_TG =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> Topo_Emo_Hap_TG[, <span class="dv">1</span>], <span class="dt">electrode =</span> Topo_Emo_Hap_TG[, </span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">amplitude =</span> Topo_Emo_Ang_TG<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Emo_Neu_TG<span class="op">$</span>amplitude)</span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true"></a></span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true"></a></span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true"></a><span class="co"># Calculate difference score happy-neutral</span></span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true"></a>Topo_Diff_Hap_Neu_TG =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> Topo_Emo_Hap_TG[, <span class="dv">1</span>], <span class="dt">electrode =</span> Topo_Emo_Hap_TG[, </span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">amplitude =</span> Topo_Emo_Hap_TG<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Emo_Neu_TG<span class="op">$</span>amplitude)</span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true"></a></span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true"></a></span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true"></a><span class="co"># Calculate difference score happy-angry</span></span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true"></a>Topo_Diff_Hap_Ang_TG =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> Topo_Emo_Hap_TG[, <span class="dv">1</span>], <span class="dt">electrode =</span> Topo_Emo_Hap_TG[, </span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">amplitude =</span> Topo_Emo_Hap_TG<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Emo_Ang_TG<span class="op">$</span>amplitude)</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true"></a></span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true"></a>Topo_Diff_Ang_Neu_TG_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Ang_Neu_TG, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">500</span>)</span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true"></a>Topo_Diff_Hap_Neu_TG_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Hap_Neu_TG, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">500</span>)</span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true"></a>Topo_Diff_Hap_Ang_TG_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Hap_Ang_TG, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">500</span>)</span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true"></a></span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true"></a><span class="co"># Add electrode information</span></span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true"></a>Topo_Diff_Ang_Neu_TG_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Ang_Neu_TG_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true"></a>Topo_Diff_Hap_Neu_TG_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Hap_Neu_TG_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true"></a>Topo_Diff_Hap_Ang_TG_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Hap_Ang_TG_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true"></a></span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true"></a><span class="co"># Draw topographies</span></span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true"></a>Topo_Diff_Ang_Neu_TG_P3_plot =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Ang_Neu_TG_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, </span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true"></a>    <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;angry – neutral&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">3.5</span>, <span class="fl">2.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true"></a></span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true"></a></span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true"></a><span class="co"># Draw topographies</span></span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true"></a>Topo_Diff_Hap_Neu_TG_P3_plot =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Hap_Neu_TG_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, </span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true"></a>    <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;  happy – neutral&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">3.5</span>, <span class="fl">2.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true"></a></span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true"></a></span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true"></a><span class="co"># Display plots</span></span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true"></a>fig_topo_P3_emo_CG =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(Topo_Diff_Hap_Neu_CG_P3_plot, Topo_Diff_Ang_Neu_CG_P3_plot, </span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true"></a>    <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true"></a></span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true"></a>fig_topo_P3_emo_TG =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(Topo_Diff_Hap_Neu_TG_P3_plot, Topo_Diff_Ang_Neu_TG_P3_plot, </span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true"></a>    <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true"></a></span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true"></a><span class="co"># ERP - Plot differences between training and control group</span></span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true"></a></span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true"></a>group.labs =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Controls&quot;</span>, <span class="st">&quot;Zirkus Empathico&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true"></a><span class="kw">names</span>(group.labs) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;CG&quot;</span>, <span class="st">&quot;TG&quot;</span>)</span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true"></a></span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true"></a>ERP_group =<span class="st"> </span><span class="kw">ggplot</span>(P1_P3_traj, <span class="kw">aes</span>(time, amplitude)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">5</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true"></a><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> cond)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> ZE_ERP_col) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;P1 &amp; P3&#39;) +</span></span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true"></a><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">strip.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;darkgrey&quot;</span>, </span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>), <span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Time [ms]&quot;</span>, <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>, </span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true"></a>    mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">8</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, </span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true"></a>    <span class="dv">600</span>, <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, </span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true"></a>    <span class="dt">xmin =</span> <span class="dv">90</span>, <span class="dt">xmax =</span> <span class="dv">130</span>, <span class="dt">ymin =</span> <span class="dv">-4</span>, <span class="dt">ymax =</span> <span class="dv">9</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">180</span>, </span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true"></a>    <span class="dt">xmax =</span> <span class="dv">220</span>, <span class="dt">ymin =</span> <span class="dv">-4</span>, <span class="dt">ymax =</span> <span class="dv">9</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">300</span>, </span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true"></a>    <span class="dt">xmax =</span> <span class="dv">500</span>, <span class="dt">ymin =</span> <span class="dv">-4</span>, <span class="dt">ymax =</span> <span class="dv">9</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>group, <span class="dt">labeller =</span> <span class="kw">labeller</span>(<span class="dt">group =</span> group.labs), </span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true"></a>    <span class="dt">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true"></a></span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true"></a></span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true"></a><span class="co"># Get legend</span></span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true"></a>Topo_Diff_leg =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Hap_Neu_TG_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, </span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true"></a>    <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">3.5</span>, </span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true"></a>    <span class="fl">2.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>, mu, <span class="st">&quot;V&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, </span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true"></a>        <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true"></a></span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true"></a>topo_leg =<span class="st"> </span><span class="kw">get_legend</span>(Topo_Diff_leg)</span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true"></a></span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true"></a><span class="co"># Combine figures</span></span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true"></a>fig_topo =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(<span class="ot">NULL</span>, fig_topo_P3_emo_CG, <span class="ot">NULL</span>, fig_topo_P3_emo_TG, </span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true"></a>    <span class="ot">NULL</span>, topo_leg, <span class="dt">ncol =</span> <span class="dv">6</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>), <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, </span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true"></a>        <span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>))</span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true"></a></span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true"></a>fig_topo_erp =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(ERP_group, fig_topo, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="dv">1</span>, </span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true"></a>    <span class="fl">0.4</span>))</span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true"></a></span>
<span id="cb2-252"><a href="#cb2-252" aria-hidden="true"></a>fig_topo_erp</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/plot_topo_erps-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">ggsave</span>(fig_topo_erp, <span class="dt">file =</span> <span class="st">&quot;zerp_erps.tiff&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
<div id="early-and-late-components" class="section level2 tabset tabset-pills">
<h2 class="tabset tabset-pills">Early and late components</h2>
<div id="p1" class="section level3">
<h3>P1</h3>
<p>For the P1, no training effect (<em>F</em>(1,58) = 0.02, <em>p</em> = 0.89), but a main effect of facial expression was found (<em>F</em>(2,116) = 5.45, <em>p</em> &lt; 0.01, <span class="math inline">\(\eta^{2}{p}\)</span> = 0.09). P1 amplitudes were larger for happy vs. neutral faces (<em>p</em> = 0.004); we detected no amplitude differences for angry vs. neutral faces (<em>p</em> = 0.09), or for happy vs. angry faces (<em>p</em> = 0.50). The interaction of training and emotion did not yield significant results (<em>F</em>(2,116) = 0.64, <em>p</em> = 0.53).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>P1_amp_all_emo_an =<span class="st"> </span><span class="kw">aov_ez</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;amplitude&quot;</span>, P1_amp_all_emo, <span class="dt">between =</span> <span class="kw">c</span>(<span class="st">&quot;group&quot;</span>), </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>    <span class="dt">within =</span> <span class="kw">c</span>(<span class="st">&quot;emotion&quot;</span>), <span class="dt">anova_table =</span> <span class="kw">list</span>(<span class="dt">correction =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">es =</span> <span class="st">&quot;pes&quot;</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="kw">pander</span>(P1_amp_all_emo_an<span class="op">$</span>anova_table)</span></code></pre></div>
<table>
<caption>Anova Table (Type 3 tests)</caption>
<colgroup>
<col width="25%" />
<col width="11%" />
<col width="11%" />
<col width="10%" />
<col width="12%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">num Df</th>
<th align="center">den Df</th>
<th align="center">MSE</th>
<th align="center">F</th>
<th align="center">pes</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>group</strong></td>
<td align="center">1</td>
<td align="center">58</td>
<td align="center">76.91</td>
<td align="center">0.01858</td>
<td align="center">0.0003203</td>
<td align="center">0.892</td>
</tr>
<tr class="even">
<td align="center"><strong>emotion</strong></td>
<td align="center">2</td>
<td align="center">116</td>
<td align="center">3.829</td>
<td align="center">5.453</td>
<td align="center">0.08593</td>
<td align="center">0.005455</td>
</tr>
<tr class="odd">
<td align="center"><strong>group:emotion</strong></td>
<td align="center">2</td>
<td align="center">116</td>
<td align="center">3.829</td>
<td align="center">0.64</td>
<td align="center">0.01091</td>
<td align="center">0.5291</td>
</tr>
</tbody>
</table>
<p><em>Post-hoc tests</em></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="co"># Display post-hoc test results</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="kw">pander</span>(P1_amp_ph_res)</span></code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="15%" />
<col width="12%" />
<col width="8%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">contrast</th>
<th align="center">estimate</th>
<th align="center">SE</th>
<th align="center">df</th>
<th align="center">t.ratio</th>
<th align="center">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">P1_amp_hap - P1_amp_neu</td>
<td align="center">1.162</td>
<td align="center">0.3572</td>
<td align="center">116</td>
<td align="center">3.253</td>
<td align="center">0.004246</td>
</tr>
<tr class="even">
<td align="center">P1_amp_hap - P1_amp_ang</td>
<td align="center">0.4043</td>
<td align="center">0.3572</td>
<td align="center">116</td>
<td align="center">1.132</td>
<td align="center">0.4967</td>
</tr>
<tr class="odd">
<td align="center">P1_amp_neu - P1_amp_ang</td>
<td align="center">-0.7577</td>
<td align="center">0.3572</td>
<td align="center">116</td>
<td align="center">-2.121</td>
<td align="center">0.09003</td>
</tr>
</tbody>
</table>
</div>
<div id="n170" class="section level3">
<h3>N170</h3>
<p>N170 amplitudes were neither modulated by training (<em>F</em>(1,58) = 0.01, <em>p</em> = 0.91), facial expression (<em>F</em>(2,116) = 0.36, <em>p</em> = 0.70), nor their interaction (<em>F</em>(2,116) = 0.39, <em>p</em> = 0.68; due to a lack of N170 hemispheric differences averaged ROI results are reported).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a>N170_amp =<span class="st"> </span><span class="kw">aov_ez</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;amplitude&quot;</span>, N170_amp_all_emo, <span class="dt">within =</span> <span class="kw">c</span>(<span class="st">&quot;emotion&quot;</span>), <span class="dt">between =</span> <span class="kw">c</span>(<span class="st">&quot;group&quot;</span>), </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>    <span class="dt">anova_table =</span> <span class="kw">list</span>(<span class="dt">correction =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">es =</span> <span class="st">&quot;pes&quot;</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a><span class="kw">pander</span>(N170_amp<span class="op">$</span>anova_table)</span></code></pre></div>
<table>
<caption>Anova Table (Type 3 tests)</caption>
<colgroup>
<col width="26%" />
<col width="11%" />
<col width="11%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">num Df</th>
<th align="center">den Df</th>
<th align="center">MSE</th>
<th align="center">F</th>
<th align="center">pes</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>group</strong></td>
<td align="center">1</td>
<td align="center">58</td>
<td align="center">16.02</td>
<td align="center">0.0139</td>
<td align="center">0.0002395</td>
<td align="center">0.9066</td>
</tr>
<tr class="even">
<td align="center"><strong>emotion</strong></td>
<td align="center">2</td>
<td align="center">116</td>
<td align="center">1.968</td>
<td align="center">0.3562</td>
<td align="center">0.006104</td>
<td align="center">0.7011</td>
</tr>
<tr class="odd">
<td align="center"><strong>group:emotion</strong></td>
<td align="center">2</td>
<td align="center">116</td>
<td align="center">1.968</td>
<td align="center">0.3895</td>
<td align="center">0.00667</td>
<td align="center">0.6783</td>
</tr>
</tbody>
</table>
</div>
<div id="p3" class="section level3">
<h3>P3</h3>
<p>Concerning the P3, we did not detect a main effect of training (<em>F</em>(1,58) = 0.01, <em>p</em> = 0.91), but a significant effect of facial expression (<em>F</em>(2,116) = 3.58, <em>p</em> = 0.02, <span class="math inline">\(\eta^{2}{p}\)</span> = 0.06). P3 amplitudes were larger for happy vs. neutral faces (<em>p</em> = 0.02), while P3 amplitudes for angry vs. neutral faces (<em>p</em> = 0.09) or happy vs. angry faces were not statistically significant (<em>p</em> = 0.83). The facial expression main effect was qualified by an interaction with training (<em>F</em>(2,116) = 3.58, <em>p</em> = 0.03, <span class="math inline">\(\eta^{2}{p}\)</span> = 0.06). Specifically, the Zirkus Empathico group showed larger P3 amplitudes for happy vs. neutral faces (<em>p</em> = 0.01); no significant differences for angry vs. neutral faces (<em>p</em> = 0.84) emerged. In contrast, P3 amplitudes for controls were larger for angry vs. neutral faces (<em>p</em> = 0.045), with no differences between happy vs. neutral faces (<em>p</em> = 0.62) None of the other post-hoc tests yielded significant results (all <em>p</em> &gt; .06).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a>P3_amp_an_all_emo =<span class="st"> </span><span class="kw">aov_ez</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;amplitude&quot;</span>, P3_amp_all_emo, <span class="dt">within =</span> <span class="kw">c</span>(<span class="st">&quot;emotion&quot;</span>), </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>    <span class="dt">between =</span> <span class="kw">c</span>(<span class="st">&quot;group&quot;</span>), <span class="dt">anova_table =</span> <span class="kw">list</span>(<span class="dt">correction =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">es =</span> <span class="st">&quot;pes&quot;</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="kw">pander</span>(P3_amp_an_all_emo<span class="op">$</span>anova_table)</span></code></pre></div>
<table>
<caption>Anova Table (Type 3 tests)</caption>
<colgroup>
<col width="25%" />
<col width="11%" />
<col width="11%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">num Df</th>
<th align="center">den Df</th>
<th align="center">MSE</th>
<th align="center">F</th>
<th align="center">pes</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>group</strong></td>
<td align="center">1</td>
<td align="center">58</td>
<td align="center">131.8</td>
<td align="center">0.0114</td>
<td align="center">0.0001966</td>
<td align="center">0.9153</td>
</tr>
<tr class="even">
<td align="center"><strong>emotion</strong></td>
<td align="center">2</td>
<td align="center">116</td>
<td align="center">3.579</td>
<td align="center">4.001</td>
<td align="center">0.06452</td>
<td align="center">0.02089</td>
</tr>
<tr class="odd">
<td align="center"><strong>group:emotion</strong></td>
<td align="center">2</td>
<td align="center">116</td>
<td align="center">3.579</td>
<td align="center">3.556</td>
<td align="center">0.05777</td>
<td align="center">0.0317</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><em>Post-hoc tests</em></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="co"># Display post-hoc test results</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a><span class="kw">pander</span>(P3_amp_ph_all_emo)</span></code></pre></div>
<table>
<colgroup>
<col width="36%" />
<col width="15%" />
<col width="12%" />
<col width="8%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">contrast</th>
<th align="center">estimate</th>
<th align="center">SE</th>
<th align="center">df</th>
<th align="center">t.ratio</th>
<th align="center">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">P3_amp_hap - P3_amp_neu</td>
<td align="center">0.9278</td>
<td align="center">0.3454</td>
<td align="center">116</td>
<td align="center">2.686</td>
<td align="center">0.0224</td>
</tr>
<tr class="even">
<td align="center">P3_amp_hap - P3_amp_ang</td>
<td align="center">0.1989</td>
<td align="center">0.3454</td>
<td align="center">116</td>
<td align="center">0.5759</td>
<td align="center">0.8332</td>
</tr>
<tr class="odd">
<td align="center">P3_amp_neu - P3_amp_ang</td>
<td align="center">-0.7289</td>
<td align="center">0.3454</td>
<td align="center">116</td>
<td align="center">-2.11</td>
<td align="center">0.09214</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="co"># Display post-hoc test results</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a><span class="kw">pander</span>(P3_amp_ph_all_emo)</span></code></pre></div>
<table>
<colgroup>
<col width="32%" />
<col width="10%" />
<col width="13%" />
<col width="11%" />
<col width="7%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">contrast</th>
<th align="center">group</th>
<th align="center">estimate</th>
<th align="center">SE</th>
<th align="center">df</th>
<th align="center">t.ratio</th>
<th align="center">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">P3_amp_hap - P3_amp_neu</td>
<td align="center">CG</td>
<td align="center">0.4577</td>
<td align="center">0.4885</td>
<td align="center">116</td>
<td align="center">0.9371</td>
<td align="center">0.618</td>
</tr>
<tr class="even">
<td align="center">P3_amp_hap - P3_amp_ang</td>
<td align="center">CG</td>
<td align="center">-0.7222</td>
<td align="center">0.4885</td>
<td align="center">116</td>
<td align="center">-1.478</td>
<td align="center">0.305</td>
</tr>
<tr class="odd">
<td align="center">P3_amp_neu - P3_amp_ang</td>
<td align="center">CG</td>
<td align="center">-1.18</td>
<td align="center">0.4885</td>
<td align="center">116</td>
<td align="center">-2.415</td>
<td align="center">0.04518</td>
</tr>
<tr class="even">
<td align="center">P3_amp_hap - P3_amp_neu</td>
<td align="center">TG</td>
<td align="center">1.398</td>
<td align="center">0.4885</td>
<td align="center">116</td>
<td align="center">2.862</td>
<td align="center">0.01375</td>
</tr>
<tr class="odd">
<td align="center">P3_amp_hap - P3_amp_ang</td>
<td align="center">TG</td>
<td align="center">1.12</td>
<td align="center">0.4885</td>
<td align="center">116</td>
<td align="center">2.293</td>
<td align="center">0.06077</td>
</tr>
<tr class="even">
<td align="center">P3_amp_neu - P3_amp_ang</td>
<td align="center">TG</td>
<td align="center">-0.2779</td>
<td align="center">0.4885</td>
<td align="center">116</td>
<td align="center">-0.569</td>
<td align="center">0.8369</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>

<div class="col-xs-2">

<div class = "btn-toolbar">
<div class="btn-group">
<a class="btn btn-raised btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" href="#"><span>Code</span> <span class="caret"></span></a>
<ul class="dropdown-menu" style="min-width: 50px;">

<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>

</ul>
</div>
</div>

</div>
</div>
	


</div>
</div>

 <script>
    $(document).ready(function () {
	// add bootstrap table styles to pandoc tables
	$('tr.header').parent('thead').parent('table').addClass('table table-striped table-hover');
	
	
		$('.pages img').addClass("image-lb");
	$('.pages').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
            delegate: '.image-lb',
	    gallery: {enabled: true },
            removalDelay: 500,
            callbacks: {
		beforeOpen: function() {
                    // just a hack that adds mfp-anim class to markup
                    this.st.image.markup = this.st.image.markup.replace('mfp-figure', 'mfp-figure mfp-with-anim');
		}
            },
            mainClass: 'mfp-move-from-top',
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	
	  
	$('#toc ul li').first().addClass("active");
	$('#toc ul li').attr("data-target", function() {
            return($(this).children("a").attr("href"));
	})
	$('body .section.level1').first().addClass("active");
	$('body .section.level1').not('.active').hide();
	
	$('#toc a[href*="#"], a[href^="#"]').click(function() {
	    var id = $(this).attr("href");
	    if (id === "#") return;
	    if (id.substring(0, 8) === "#dyntab-") return;
	    // Menu
	    var menu_entry = $(".menu li[data-target='"+id+"']");
	    if (menu_entry.length == 0) {
		window.location.hash = id;
		return;
	    }
	    menu_entry.addClass("active");
	    $(".menu li").not(menu_entry).removeClass("active"); 
	    toggle_page(id);
	});

	function toggle_page(id) {
	    $(".page").not(page).removeClass("active").hide();
	    window.page = id;
	    var page = $(window.page);
	    window.location.hash = window.page;
	    //$(this).addClass("active");
	    page.show();

	    var totop = setInterval(function () {
		$(".pages").animate({scrollTop: 0}, 0);
	    }, 10);

	    setTimeout(function () {
		page.addClass("active");
		setTimeout(function () {
		    clearInterval(totop);
		}, 1000);
	    }, 100);
	    
	    window.dispatchEvent(new Event('resize'));
	}


	$(".menu li").click(function () {
	    toggle_page($(this).data("target"));
	    // Menu
	    if (!$(this).data("target")) return;
	    if ($(this).is(".active")) return;
	    $(".menu li").not($(this)).removeClass("active");
	    $(this).addClass("active");
	});
  
	  
	window.page = window.location.hash;
	if (window.page != "") {
	    $(".menu").find("li[data-target=" + window.page + "]").trigger("click");
	}
	/* init material bootstrap js */
	$.material.init();
    });
 </script>


  <!-- dynamically load mathjax for compatibility with self-contained -->
 <script>
   (function () {
       var script = document.createElement("script");
       script.type = "text/javascript";
       script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
       document.getElementsByTagName("head")[0].appendChild(script);
   })();
 </script>
 
</body>
</html>
