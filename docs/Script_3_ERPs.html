<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>ERP measures</title>
<!-- Material Design fonts -->
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<script src="site_libs/header-attrs-2.3/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
<script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
<link href="site_libs/bootstrap_material-0.1/bootstrap-material-design.min.css" rel="stylesheet" />
<link href="site_libs/bootstrap_material-0.1/ripples.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap_material-0.1/material.min.js"></script>
<script src="site_libs/bootstrap_material-0.1/ripples.min.js"></script>
<link href="site_libs/material-0.1/material.css" rel="stylesheet" />
<script src="site_libs/material-0.1/material.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<link rel="stylesheet" href="web_style.css" type="text/css" />

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("toc");
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

</head>

<body>

<div class="header-panel shadow z-2">
    <div class="container-fluid">
        <div class="row">
            <div class="col-xs-3">
        <div id="header">
    <h1 class="title">ERP measures</h1>
                </div>
    </div>
</div>
</div>
</div>


<div class="container-fluid main-container">
    <div class="row">
      <nav class="col-xs-3 menu">
        <div id="toc">
        <ul>
        <li><a href="#individual-grand-average-visual-inspection">Individual / Grand-average visual inspection</a></li>
        <li><a href="#visualization-group-differences">Visualization group differences</a></li>
        <li><a href="#mean-amplitude-analyses">Mean amplitude analyses</a></li>
        </ul>
        </div>
        
        
        
      </nav>
     <div class="pages col-xs-9">
     <div class="row">
       <div class="col-xs-10">


<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naumann et al.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-info-sign"></span>
     
    Introduction
  </a>
</li>
<li>
  <a href="Script_1_Sampl_Descr.html">
    <span class="glyphicon glyphicon glyphicon glyphicon-education"></span>
     
    Sample description
  </a>
</li>
<li>
  <a href="Script_2_Report_Measures.html">
    <span class="glyphicon glyphicon-hand-up"></span>
     
    Self-/Parental report
  </a>
</li>
<li>
  <a href="Script_3_ERP_Measures.html">
    <span class="glyphicon glyphicon-user"></span>
     
    ERPs
  </a>
</li>
<li>
  <a href="Script_4_Brain_Behavior.html">
    <span class="glyphicon glyphicon-resize-small"></span>
     
    Brain-Behavior
  </a>
</li>
<li>
  <a href="Script_5_Supplement.html">
    <span class="glyphicon glyphicon glyphicon glyphicon-piggy-bank"></span>
     
    Supplementary
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://osf.io/nas48/">
    <span class="ai ai ai ai-osf ai-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:sandra.naumann@hu-berlin.de">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">


<!-- Set up workspace -->
<div id="individual-grand-average-visual-inspection" class="section level1 tabset tabset-pills">
<h1 class="tabset tabset-pills">Individual / Grand-average visual inspection</h1>
<div id="topographies-across-time" class="section level2">
<h2>Topographies across time</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="cf">if</span> (graph <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>    </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>    <span class="co"># Change from wide to long format</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a>    ga_topo_long =<span class="st"> </span><span class="kw">gather</span>(ga_topo_wide, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a>    <span class="co"># Topoplots</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a>    </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a>    <span class="co"># Rename A1/A2</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a>    <span class="kw">names</span>(ga_topo_long)[<span class="kw">names</span>(ga_topo_long) <span class="op">==</span><span class="st"> &quot;A1&quot;</span>] &lt;-<span class="st"> &quot;TP9&quot;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a>    <span class="kw">names</span>(ga_topo_long)[<span class="kw">names</span>(ga_topo_long) <span class="op">==</span><span class="st"> &quot;A2&quot;</span>] &lt;-<span class="st"> &quot;TP10&quot;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a>    </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a>    <span class="co"># Electrode locations</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a>    ga_topo_long =<span class="st"> </span><span class="kw">electrode_locations</span>(ga_topo_long, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a>        <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a>    </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true"></a>    </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true"></a>    <span class="co"># Select 1st time window</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true"></a>    ga_topo_tw1 =<span class="st"> </span>ga_topo_long[(ga_topo_long<span class="op">$</span>time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(ga_topo_long<span class="op">$</span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">100</span>), </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true"></a>        ]</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true"></a>    </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true"></a>    <span class="co"># Plot topoplot for first time window</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true"></a>    ga_topo_tw1_plot =<span class="st"> </span><span class="kw">ggplot</span>(ga_topo_tw1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true"></a><span class="st">        </span><span class="kw">ggtitle</span>(<span class="st">&quot;0-100ms&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;text&quot;</span>, </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true"></a>        <span class="dt">chan_size =</span> <span class="dv">2</span>, <span class="dt">head_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">130</span>, </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true"></a>        <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true"></a>    </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true"></a>    <span class="co"># Select 2nd time window</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true"></a>    ga_topo_tw2 =<span class="st"> </span>ga_topo_long[(ga_topo_long<span class="op">$</span>time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">100</span>) <span class="op">&amp;</span><span class="st"> </span>(ga_topo_long<span class="op">$</span>time <span class="op">&lt;=</span><span class="st"> </span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true"></a><span class="st">        </span><span class="dv">200</span>), ]</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true"></a>    </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true"></a>    <span class="co"># Plot topoplot for first time window</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true"></a>    ga_topo_tw2_plot =<span class="st"> </span><span class="kw">ggplot</span>(ga_topo_tw2, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true"></a><span class="st">        </span><span class="kw">ggtitle</span>(<span class="st">&quot;100-200ms&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;text&quot;</span>, </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true"></a>        <span class="dt">chan_size =</span> <span class="dv">2</span>, <span class="dt">head_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">130</span>, </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true"></a>        <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true"></a>    </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true"></a>    <span class="co"># Select 3rd time window</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true"></a>    ga_topo_tw3 =<span class="st"> </span>ga_topo_long[(ga_topo_long<span class="op">$</span>time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">200</span>) <span class="op">&amp;</span><span class="st"> </span>(ga_topo_long<span class="op">$</span>time <span class="op">&lt;=</span><span class="st"> </span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true"></a><span class="st">        </span><span class="dv">300</span>), ]</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true"></a>    </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true"></a>    <span class="co"># Plot topoplot for first time window</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true"></a>    ga_topo_tw3_plot =<span class="st"> </span><span class="kw">ggplot</span>(ga_topo_tw3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true"></a><span class="st">        </span><span class="kw">ggtitle</span>(<span class="st">&quot;200-300ms&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;text&quot;</span>, </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true"></a>        <span class="dt">chan_size =</span> <span class="dv">2</span>, <span class="dt">head_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">130</span>, </span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true"></a>        <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true"></a>    </span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true"></a>    <span class="co"># Select 4th time window</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true"></a>    ga_topo_tw4 =<span class="st"> </span>ga_topo_long[(ga_topo_long<span class="op">$</span>time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span>) <span class="op">&amp;</span><span class="st"> </span>(ga_topo_long<span class="op">$</span>time <span class="op">&lt;=</span><span class="st"> </span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true"></a><span class="st">        </span><span class="dv">400</span>), ]</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true"></a>    </span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true"></a>    <span class="co"># Plot topoplot for first time window</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true"></a>    ga_topo_tw4_plot =<span class="st"> </span><span class="kw">ggplot</span>(ga_topo_tw4, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true"></a><span class="st">        </span><span class="kw">ggtitle</span>(<span class="st">&quot;300-400ms&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;text&quot;</span>, </span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true"></a>        <span class="dt">chan_size =</span> <span class="dv">2</span>, <span class="dt">head_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">130</span>, </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true"></a>        <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true"></a>    </span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true"></a>    <span class="co"># Select 5th time window</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true"></a>    ga_topo_tw5 =<span class="st"> </span>ga_topo_long[(ga_topo_long<span class="op">$</span>time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">400</span>) <span class="op">&amp;</span><span class="st"> </span>(ga_topo_long<span class="op">$</span>time <span class="op">&lt;=</span><span class="st"> </span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true"></a><span class="st">        </span><span class="dv">500</span>), ]</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true"></a>    </span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true"></a>    <span class="co"># Plot topoplot for first time window</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true"></a>    ga_topo_tw5_plot =<span class="st"> </span><span class="kw">ggplot</span>(ga_topo_tw5, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true"></a><span class="st">        </span><span class="kw">ggtitle</span>(<span class="st">&quot;400-500ms&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;text&quot;</span>, </span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true"></a>        <span class="dt">chan_size =</span> <span class="dv">2</span>, <span class="dt">head_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">130</span>, </span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true"></a>        <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true"></a>    </span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true"></a>    </span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true"></a>    <span class="co"># Select 6th time window</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true"></a>    ga_topo_tw6 =<span class="st"> </span>ga_topo_long[(ga_topo_long<span class="op">$</span>time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">500</span>) <span class="op">&amp;</span><span class="st"> </span>(ga_topo_long<span class="op">$</span>time <span class="op">&lt;=</span><span class="st"> </span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true"></a><span class="st">        </span><span class="dv">600</span>), ]</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true"></a>    </span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true"></a>    <span class="co"># Plot topoplot for first time window</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true"></a>    ga_topo_tw6_plot =<span class="st"> </span><span class="kw">ggplot</span>(ga_topo_tw6, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true"></a><span class="st">        </span><span class="kw">ggtitle</span>(<span class="st">&quot;500-600ms&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;text&quot;</span>, </span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true"></a>        <span class="dt">chan_size =</span> <span class="dv">2</span>, <span class="dt">head_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">130</span>, </span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true"></a>        <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true"></a>    </span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true"></a>    <span class="co"># Display plots</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true"></a>    fig_ga_topo =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(ga_topo_tw1_plot, ga_topo_tw2_plot, ga_topo_tw3_plot, </span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true"></a>        ga_topo_tw4_plot, ga_topo_tw5_plot, ga_topo_tw6_plot, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, </span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true"></a>            <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true"></a>    fig_ga_topo</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true"></a>    </span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true"></a>}</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/plot_ga_topo_tws-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><br></p>
</div>
<div id="topographies-specific-to-time-windows-of-p1-n170-p3" class="section level2">
<h2>Topographies specific to time windows of P1, N170, P3</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="cf">if</span> (graph <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>    </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a>    <span class="co"># Change from wide to long format</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a>    ga_topo_long =<span class="st"> </span><span class="kw">gather</span>(ga_topo_wide, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a>    </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>    <span class="co"># Topoplots</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a>    </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a>    <span class="co"># Rename A1/A2</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a>    <span class="kw">names</span>(ga_topo_long)[<span class="kw">names</span>(ga_topo_long) <span class="op">==</span><span class="st"> &quot;A1&quot;</span>] &lt;-<span class="st"> &quot;TP9&quot;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a>    <span class="kw">names</span>(ga_topo_long)[<span class="kw">names</span>(ga_topo_long) <span class="op">==</span><span class="st"> &quot;A2&quot;</span>] &lt;-<span class="st"> &quot;TP10&quot;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a>    </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a>    </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a>    <span class="co"># Electrode locations</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a>    ga_topo_long =<span class="st"> </span><span class="kw">electrode_locations</span>(ga_topo_long, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a>        <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true"></a>    </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true"></a>    </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true"></a>    <span class="co"># Select P1 time window</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true"></a>    ga_topo_P1 =<span class="st"> </span>ga_topo_long[(ga_topo_long<span class="op">$</span>time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">80</span>) <span class="op">&amp;</span><span class="st"> </span>(ga_topo_long<span class="op">$</span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">120</span>), </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true"></a>        ]</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true"></a>    </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true"></a>    <span class="co"># Plot topoplot for P1</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true"></a>    ga_topo_P1_plot =<span class="st"> </span><span class="kw">ggplot</span>(ga_topo_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true"></a><span class="st">        </span><span class="kw">ggtitle</span>(<span class="st">&quot;P1&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;text&quot;</span>, </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true"></a>        <span class="dt">chan_size =</span> <span class="dv">2</span>, <span class="dt">head_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">110</span>, </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true"></a>        <span class="dv">180</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true"></a>    </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true"></a>    </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true"></a>    <span class="co"># Select N170 time window</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true"></a>    ga_topo_N170 =<span class="st"> </span>ga_topo_long[(ga_topo_long<span class="op">$</span>time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">160</span>) <span class="op">&amp;</span><span class="st"> </span>(ga_topo_long<span class="op">$</span>time <span class="op">&lt;=</span><span class="st"> </span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true"></a><span class="st">        </span><span class="dv">200</span>), ]</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true"></a>    </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true"></a>    <span class="co"># Plot topoplot for N170</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true"></a>    ga_topo_N170_plot =<span class="st"> </span><span class="kw">ggplot</span>(ga_topo_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true"></a>        <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;N170&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, </span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true"></a>        <span class="dt">chan_markers =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">2</span>, <span class="dt">head_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, </span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true"></a>        <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">50</span>, <span class="dv">80</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true"></a>    </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true"></a>    <span class="co"># Select P3 time window</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true"></a>    ga_topo_P3 =<span class="st"> </span>ga_topo_long[(ga_topo_long<span class="op">$</span>time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span>) <span class="op">&amp;</span><span class="st"> </span>(ga_topo_long<span class="op">$</span>time <span class="op">&lt;=</span><span class="st"> </span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true"></a><span class="st">        </span><span class="dv">500</span>), ]</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true"></a>    </span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true"></a>    <span class="co"># Plot topoplot for P3</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true"></a>    ga_topo_P3_plot =<span class="st"> </span><span class="kw">ggplot</span>(ga_topo_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true"></a><span class="st">        </span><span class="kw">ggtitle</span>(<span class="st">&quot;P3&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;text&quot;</span>, </span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true"></a>        <span class="dt">chan_size =</span> <span class="dv">2</span>, <span class="dt">head_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">120</span>, </span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true"></a>        <span class="dv">190</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true"></a>    </span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true"></a>    <span class="co"># Display plots</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true"></a>    fig_ga_topo_erps =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(ga_topo_P1_plot, ga_topo_N170_plot, ga_topo_P3_plot, </span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true"></a>        <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true"></a>    fig_ga_topo_erps</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true"></a>    </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true"></a>}</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/plot_ga_topo_erps-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><br></p>
</div>
<div id="grand-average-across-all-conditions-participants-and-roi" class="section level2">
<h2>Grand average across all conditions, participants and ROI</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="cf">if</span> (graph <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>    </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>    <span class="co"># Change from wide to long format</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>    ga_traj_long =<span class="st"> </span><span class="kw">gather</span>(ga_traj_wide, electrode, amplitude, P7<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>    </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>    <span class="co"># Plot data</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a>    <span class="kw">ggplot</span>(ga_traj_long, <span class="kw">aes</span>(time, amplitude)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Grand average across ROI&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a><span class="st">        </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a>            <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a>            <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a><span class="st">        </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a><span class="st">        </span><span class="kw">scale_color_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>, <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Mean amplitude across ROI [&quot;</span>, </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a>            mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">40</span>, </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a>        <span class="dv">150</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">40</span>, <span class="dv">150</span>, <span class="dv">20</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a><span class="st">        </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>, <span class="dv">100</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a>        <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a>        <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true"></a>    </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true"></a>}</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/plot_ga_traj-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><br></p>
</div>
<div id="averaged-erps-for-p1-n170-leftright-and-p3" class="section level2">
<h2>Averaged ERPs for P1, N170 (left/right) and P3</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="cf">if</span> (graph <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>    </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a>    <span class="co"># Plot data</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a>    <span class="kw">ggplot</span>(P1_P3_traj, <span class="kw">aes</span>(time, amplitude)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a>        <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a>            <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a>        <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> cond)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> ZE_ERP_col) <span class="op">+</span><span class="st"> </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a><span class="st">        </span><span class="kw">ggtitle</span>(<span class="st">&quot;P1 &amp; P3&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>, </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a>        <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Mean amplitude across ROI [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a><span class="st">        </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">10</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>, </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a>        <span class="dv">10</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>, <span class="dv">100</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a>        <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a>        <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a>    </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true"></a>}</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/plot_P1_P3_av-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="cf">if</span> (graph <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>    </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a>    <span class="co"># N170 left hemisphere</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a>    N170_l_traj_plot =<span class="st"> </span><span class="kw">ggplot</span>(N170_l_traj, <span class="kw">aes</span>(time, amplitude)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a>        <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>            <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a>        <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> cond)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> ZE_ERP_col) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a><span class="st">        </span><span class="kw">ggtitle</span>(<span class="st">&quot;Left hemisphere: N170&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>, </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a>        <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Mean amplitude across ROI [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a><span class="st">        </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">10</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>, </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a>        <span class="dv">10</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>, <span class="dv">100</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a>        <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a>        <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true"></a>    </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true"></a>    </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true"></a>    <span class="co"># N170 right hemisphere</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true"></a>    N170_r_traj_plot =<span class="st"> </span><span class="kw">ggplot</span>(N170_r_traj, <span class="kw">aes</span>(time, amplitude)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true"></a>        <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true"></a>            <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true"></a>        <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> cond)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> ZE_ERP_col) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true"></a><span class="st">        </span><span class="kw">ggtitle</span>(<span class="st">&quot;Right hemisphere: N170&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>, </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true"></a>        <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Mean amplitude across ROI [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true"></a><span class="st">        </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>, <span class="dv">22</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">8</span>, </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true"></a>        <span class="dv">22</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>, <span class="dv">100</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true"></a>        <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true"></a>        <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true"></a>    </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true"></a>    </span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true"></a>    <span class="co"># Display plots</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true"></a>    fig_traj_n170 =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(N170_l_traj_plot, N170_r_traj_plot, <span class="dt">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true"></a>        <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true"></a>    fig_traj_n170</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true"></a>    </span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true"></a>}</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/plot_N170_av-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><br></p>
</div>
<div id="individual-erps" class="section level2">
<h2>Individual ERPs</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="cf">if</span> (graph <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>    </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>    <span class="co"># Plot data</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>    <span class="kw">ggplot</span>(P1_P3_traj, <span class="kw">aes</span>(time, amplitude)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a>        <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a>            <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a>        <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> cond)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> ZE_ERP_col) <span class="op">+</span><span class="st"> </span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a><span class="st">        </span><span class="kw">ggtitle</span>(<span class="st">&quot;P1 &amp; P3&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a>        <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Mean amplitude across ROI [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a><span class="st">        </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">20</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>, </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a>        <span class="dv">20</span>, <span class="dv">10</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>, <span class="dv">300</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a>        <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true"></a>        <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>ID, <span class="dt">nrow =</span> <span class="dv">25</span>, <span class="dt">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true"></a>    </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true"></a>}</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/plot_P1_P3_indiv-1.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="visualization-group-differences" class="section level1">
<h1>Visualization group differences</h1>
<div id="variables" class="section level2 tabset tabset-pills">
<h2 class="tabset tabset-pills">Variables</h2>
<div id="training-vs-control-group" class="section level3">
<h3>Training vs control group</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="co"># Plot differences between training and control group</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="kw">ggplot</span>(P1_P3_traj, <span class="kw">aes</span>(time, amplitude)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a>        <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="fl">1.2</span>, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a>    <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> cond)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> ZE_ERP_col) <span class="op">+</span><span class="st"> </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;P1 &amp; P3&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>, </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Mean amplitude across ROI [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">8</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>, </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a>    <span class="dv">8</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>, <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a>    <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a>    <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>group, <span class="dt">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/traj_group-1.png" width="576" style="display: block; margin: auto;" /></p>
<div id="boxplots-amplitude-latency" class="section level4 tabset tabset-pills">
<h4 class="tabset tabset-pills">Boxplots amplitude / latency</h4>
<div id="p1-amplitude" class="section level5">
<h5>P1 amplitude</h5>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="co"># Draw boxplot</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a><span class="kw">ggplot</span>(P1_amp_emo_neu, <span class="kw">aes</span>(<span class="dt">x =</span> emotion, <span class="dt">y =</span> amplitude, <span class="dt">fill =</span> group)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="dt">lwd =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Amplitude [mV]&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;happy&quot;</span>, <span class="st">&quot;neutral&quot;</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>    <span class="st">&quot;angry&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#707070&quot;</span>, <span class="st">&quot;#c9985f&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/boxplot_group_P1_amp-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="n170-amplitude-across-hemispheres" class="section level5">
<h5>N170 amplitude across hemispheres</h5>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="co"># Draw boxplot</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a><span class="kw">ggplot</span>(N170_amp_all_emo, <span class="kw">aes</span>(<span class="dt">x =</span> emotion, <span class="dt">y =</span> amplitude, <span class="dt">fill =</span> group)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="dt">lwd =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Amplitude [mV]&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;happy&quot;</span>, <span class="st">&quot;neutral&quot;</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a>    <span class="st">&quot;angry&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#707070&quot;</span>, <span class="st">&quot;#c9985f&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/boxplot_group_N170_amp-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="n170-amplitude-left-vs.-right-hemisphere" class="section level5">
<h5>N170 amplitude left vs.right hemisphere</h5>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="co"># Draw boxplot</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a>N170_left_amp =<span class="st"> </span><span class="kw">ggplot</span>(N170_left_amp_box, <span class="kw">aes</span>(<span class="dt">x =</span> emotion, <span class="dt">y =</span> amplitude, <span class="dt">fill =</span> group)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">lwd =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Amplitude [mV]&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;happy&quot;</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a>    <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;angry&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#707070&quot;</span>, <span class="st">&quot;#c9985f&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_bw</span>()</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a><span class="co"># Draw boxplot</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a>N170_right_amp =<span class="st"> </span><span class="kw">ggplot</span>(N170_right_amp_box, <span class="kw">aes</span>(<span class="dt">x =</span> emotion, <span class="dt">y =</span> amplitude, <span class="dt">fill =</span> group)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">lwd =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Amplitude [mV]&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;happy&quot;</span>, </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a>    <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;angry&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#707070&quot;</span>, <span class="st">&quot;#c9985f&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_bw</span>()</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true"></a><span class="co"># Show figures</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true"></a>fig_N170_left_right =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(N170_left_amp, N170_right_amp, <span class="dt">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true"></a>    <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true"></a>fig_N170_left_right</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/boxplot_group_N170_amp_left_right-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="p3-amplitude" class="section level5">
<h5>P3 amplitude</h5>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="co"># Draw boxplot</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a><span class="kw">ggplot</span>(P3_amp_all_emo, <span class="kw">aes</span>(<span class="dt">x =</span> emotion, <span class="dt">y =</span> amplitude, <span class="dt">fill =</span> group)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="dt">lwd =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Amplitude [mV]&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;happy&quot;</span>, <span class="st">&quot;neutral&quot;</span>, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a>    <span class="st">&quot;angry&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#707070&quot;</span>, <span class="st">&quot;#c9985f&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/boxplot_group_P3_amp-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="p1-latency" class="section level5">
<h5>P1 latency</h5>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="co"># Draw boxplot</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="kw">ggplot</span>(P1_lat_box, <span class="kw">aes</span>(<span class="dt">x =</span> emotion, <span class="dt">y =</span> latency, <span class="dt">fill =</span> group)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="dt">lwd =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Latency [ms]&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;happy&quot;</span>, <span class="st">&quot;neutral&quot;</span>, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a>    <span class="st">&quot;angry&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#707070&quot;</span>, <span class="st">&quot;#c9985f&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/boxplot_group_P1_lat-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="n170-latency" class="section level5">
<h5>N170 latency</h5>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="co"># Draw boxplot</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a><span class="kw">ggplot</span>(N170_lat_box, <span class="kw">aes</span>(<span class="dt">x =</span> emotion, <span class="dt">y =</span> latency, <span class="dt">fill =</span> group)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="dt">lwd =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Latency [ms]&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;happy&quot;</span>, <span class="st">&quot;neutral&quot;</span>, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>    <span class="st">&quot;angry&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#707070&quot;</span>, <span class="st">&quot;#c9985f&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/boxplot_group_N170_lat-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="n170-latency-left-vs.-right-hemisphere" class="section level5">
<h5>N170 latency left vs.right hemisphere</h5>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="co"># Draw boxplot</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a>N170_left_lat =<span class="st"> </span><span class="kw">ggplot</span>(N170_left_lat_box, <span class="kw">aes</span>(<span class="dt">x =</span> emotion, <span class="dt">y =</span> latency, <span class="dt">fill =</span> group)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">lwd =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;latency [ms]&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;happy&quot;</span>, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a>    <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;angry&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#707070&quot;</span>, <span class="st">&quot;#c9985f&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_bw</span>()</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true"></a><span class="co"># Draw boxplot</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true"></a>N170_right_lat =<span class="st"> </span><span class="kw">ggplot</span>(N170_right_lat_box, <span class="kw">aes</span>(<span class="dt">x =</span> emotion, <span class="dt">y =</span> latency, <span class="dt">fill =</span> group)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">lwd =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;latency [ms]&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;happy&quot;</span>, </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true"></a>    <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;angry&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#707070&quot;</span>, <span class="st">&quot;#c9985f&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_bw</span>()</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true"></a><span class="co"># Show figures</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true"></a>fig_N170_left_right =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(N170_left_lat, N170_right_lat, <span class="dt">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true"></a>    <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true"></a>fig_N170_left_right</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/boxplot_group_N170_lat_left_right-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="age" class="section level3">
<h3>Age</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="co"># Plot age differences</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a><span class="kw">ggplot</span>(P1_P3_traj, <span class="kw">aes</span>(time, amplitude)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a>        <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a>    <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> cond)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> ZE_ERP_col) <span class="op">+</span><span class="st"> </span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;P1 &amp; P3&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Mean amplitude across ROI [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">9</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true"></a>    <span class="dv">9</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>, <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true"></a>    <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true"></a>    <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>age_split, <span class="dt">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/traj_age-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="sex" class="section level3">
<h3>Sex</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="co"># Plot sex differences</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a><span class="kw">ggplot</span>(P1_P3_traj, <span class="kw">aes</span>(time, amplitude)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a>        <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a>    <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> cond)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> ZE_ERP_col) <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;P1 &amp; P3&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>, </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Mean amplitude across ROI [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">9</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>, </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true"></a>    <span class="dv">9</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>, <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true"></a>    <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true"></a>    <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>sex, <span class="dt">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="Script_3_ERPs_files/figure-html/traj_sex-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="mean-amplitude-analyses" class="section level1 tabset tabset-pills">
<h1 class="tabset tabset-pills">Mean amplitude analyses</h1>
<div id="anovas" class="section level2">
<h2>ANOVAs</h2>
<p><br></p>
<p><strong>P1 differ between all emotions</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a>  P1_amp_all_emo_an =<span class="st">  </span><span class="kw">aov_ez</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;amplitude&quot;</span>, P1_amp_all_emo, <span class="dt">between =</span> <span class="kw">c</span>(<span class="st">&quot;group&quot;</span>),</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a>                      <span class="dt">within =</span> <span class="kw">c</span>(<span class="st">&quot;emotion&quot;</span>) ,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a>                      <span class="co">#covariate = c(&quot;mc_app_time&quot;,&quot;mc_CPM&quot;),</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a>                      <span class="co">#observed = c(&quot;mc_app_time&quot;,&quot;mc_CPM&quot;), factorize = FALSE, </span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a>                  <span class="dt">anova_table =</span> <span class="kw">list</span>(<span class="dt">correction =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">es =</span> <span class="st">&quot;pes&quot;</span>))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>  <span class="kw">pander</span>(P1_amp_all_emo_an<span class="op">$</span>anova_table)</span></code></pre></div>
<table>
<caption>Anova Table (Type 3 tests)</caption>
<colgroup>
<col width="25%" />
<col width="11%" />
<col width="11%" />
<col width="10%" />
<col width="12%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">num Df</th>
<th align="center">den Df</th>
<th align="center">MSE</th>
<th align="center">F</th>
<th align="center">pes</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>group</strong></td>
<td align="center">1</td>
<td align="center">58</td>
<td align="center">76.91</td>
<td align="center">0.01858</td>
<td align="center">0.0003203</td>
<td align="center">0.892</td>
</tr>
<tr class="even">
<td align="center"><strong>emotion</strong></td>
<td align="center">2</td>
<td align="center">116</td>
<td align="center">3.829</td>
<td align="center">5.453</td>
<td align="center">0.08593</td>
<td align="center">0.005455</td>
</tr>
<tr class="odd">
<td align="center"><strong>group:emotion</strong></td>
<td align="center">2</td>
<td align="center">116</td>
<td align="center">3.829</td>
<td align="center">0.64</td>
<td align="center">0.01091</td>
<td align="center">0.5291</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><em>Post-hoc tests</em></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="co"># Display post-hoc test results</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a><span class="kw">pander</span>(P1_amp_ph_res)</span></code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="15%" />
<col width="12%" />
<col width="8%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">contrast</th>
<th align="center">estimate</th>
<th align="center">SE</th>
<th align="center">df</th>
<th align="center">t.ratio</th>
<th align="center">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">P1_amp_hap - P1_amp_neu</td>
<td align="center">1.162</td>
<td align="center">0.3572</td>
<td align="center">116</td>
<td align="center">3.253</td>
<td align="center">0.004246</td>
</tr>
<tr class="even">
<td align="center">P1_amp_hap - P1_amp_ang</td>
<td align="center">0.4043</td>
<td align="center">0.3572</td>
<td align="center">116</td>
<td align="center">1.132</td>
<td align="center">0.4967</td>
</tr>
<tr class="odd">
<td align="center">P1_amp_neu - P1_amp_ang</td>
<td align="center">-0.7577</td>
<td align="center">0.3572</td>
<td align="center">116</td>
<td align="center">-2.121</td>
<td align="center">0.09003</td>
</tr>
</tbody>
</table>
<p><strong>P1 differ between emotional vs.neutral faces</strong></p>
<p><em>Post-hoc tests</em></p>
<p><br></p>
<p><strong>N170 across hemispheres</strong></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a>  N170_amp =<span class="st">  </span><span class="kw">aov_ez</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;amplitude&quot;</span>, N170_amp_all_emo, <span class="dt">within =</span> <span class="kw">c</span>(<span class="st">&quot;emotion&quot;</span>), <span class="dt">between =</span> <span class="kw">c</span>(<span class="st">&quot;group&quot;</span>),</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a>                     <span class="co"># covariate = c(&quot;mc_app_time&quot;,&quot;mc_CPM&quot;),</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a>                      <span class="co">#observed = c(&quot;mc_app_time&quot;,&quot;mc_CPM&quot;), factorize = FALSE,</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a>                      <span class="dt">anova_table =</span> <span class="kw">list</span>(<span class="dt">correction =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">es =</span> <span class="st">&quot;pes&quot;</span>))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a>  <span class="kw">pander</span>(N170_amp<span class="op">$</span>anova_table)</span></code></pre></div>
<table>
<caption>Anova Table (Type 3 tests)</caption>
<colgroup>
<col width="26%" />
<col width="11%" />
<col width="11%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">num Df</th>
<th align="center">den Df</th>
<th align="center">MSE</th>
<th align="center">F</th>
<th align="center">pes</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>group</strong></td>
<td align="center">1</td>
<td align="center">58</td>
<td align="center">16.02</td>
<td align="center">0.0139</td>
<td align="center">0.0002395</td>
<td align="center">0.9066</td>
</tr>
<tr class="even">
<td align="center"><strong>emotion</strong></td>
<td align="center">2</td>
<td align="center">116</td>
<td align="center">1.968</td>
<td align="center">0.3562</td>
<td align="center">0.006104</td>
<td align="center">0.7011</td>
</tr>
<tr class="odd">
<td align="center"><strong>group:emotion</strong></td>
<td align="center">2</td>
<td align="center">116</td>
<td align="center">1.968</td>
<td align="center">0.3895</td>
<td align="center">0.00667</td>
<td align="center">0.6783</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>N170 separated by hemisphere</strong></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a>  N170_amp =<span class="st">  </span><span class="kw">aov_ez</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;amplitude&quot;</span>, N170_amp_hem_comp, <span class="dt">within =</span> <span class="kw">c</span>(<span class="st">&quot;emotion_rec&quot;</span>,<span class="st">&quot;hem&quot;</span>), <span class="dt">between =</span> <span class="kw">c</span>(<span class="st">&quot;group&quot;</span>),</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a>                     <span class="co"># covariate = c(&quot;mc_app_time&quot;,&quot;mc_CPM&quot;),</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a>                      <span class="co">#observed = c(&quot;mc_app_time&quot;,&quot;mc_CPM&quot;), factorize = FALSE,</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a>                      <span class="dt">anova_table =</span> <span class="kw">list</span>(<span class="dt">correction =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">es =</span> <span class="st">&quot;pes&quot;</span>))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true"></a>  <span class="kw">pander</span>(N170_amp<span class="op">$</span>anova_table)</span></code></pre></div>
<table style="width:100%;">
<caption>Anova Table (Type 3 tests)</caption>
<colgroup>
<col width="33%" />
<col width="10%" />
<col width="10%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">num Df</th>
<th align="center">den Df</th>
<th align="center">MSE</th>
<th align="center">F</th>
<th align="center">pes</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>group</strong></td>
<td align="center">1</td>
<td align="center">58</td>
<td align="center">32.04</td>
<td align="center">0.0139</td>
<td align="center">0.0002395</td>
<td align="center">0.9066</td>
</tr>
<tr class="even">
<td align="center"><strong>emotion_rec</strong></td>
<td align="center">2</td>
<td align="center">116</td>
<td align="center">3.935</td>
<td align="center">0.3562</td>
<td align="center">0.006104</td>
<td align="center">0.7011</td>
</tr>
<tr class="odd">
<td align="center"><strong>group:emotion_rec</strong></td>
<td align="center">2</td>
<td align="center">116</td>
<td align="center">3.935</td>
<td align="center">0.3895</td>
<td align="center">0.00667</td>
<td align="center">0.6783</td>
</tr>
<tr class="even">
<td align="center"><strong>hem</strong></td>
<td align="center">1</td>
<td align="center">58</td>
<td align="center">18.16</td>
<td align="center">1.627</td>
<td align="center">0.02729</td>
<td align="center">0.2072</td>
</tr>
<tr class="odd">
<td align="center"><strong>group:hem</strong></td>
<td align="center">1</td>
<td align="center">58</td>
<td align="center">18.16</td>
<td align="center">0.3653</td>
<td align="center">0.00626</td>
<td align="center">0.5479</td>
</tr>
<tr class="even">
<td align="center"><strong>emotion_rec:hem</strong></td>
<td align="center">2</td>
<td align="center">116</td>
<td align="center">2.455</td>
<td align="center">0.4597</td>
<td align="center">0.007864</td>
<td align="center">0.6326</td>
</tr>
<tr class="odd">
<td align="center"><strong>group:emotion_rec:hem</strong></td>
<td align="center">2</td>
<td align="center">116</td>
<td align="center">2.455</td>
<td align="center">0.3521</td>
<td align="center">0.006034</td>
<td align="center">0.704</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>P3 differ between all emotions</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a>  P3_amp_an_all_emo =<span class="st">  </span><span class="kw">aov_ez</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;amplitude&quot;</span>, P3_amp_all_emo, <span class="dt">within =</span> <span class="kw">c</span>(<span class="st">&quot;emotion&quot;</span>), <span class="dt">between =</span> <span class="kw">c</span>(<span class="st">&quot;group&quot;</span>),</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a>                     <span class="co"># covariate = c(&quot;mc_app_time&quot;,&quot;mc_CPM&quot;),</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a>                    <span class="co">#  observed = c(&quot;mc_app_time&quot;,&quot;mc_CPM&quot;), factorize = FALSE,</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true"></a>                   <span class="dt">anova_table =</span> <span class="kw">list</span>(<span class="dt">correction =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">es =</span> <span class="st">&quot;pes&quot;</span>))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true"></a>  <span class="kw">pander</span>(P3_amp_an_all_emo<span class="op">$</span>anova_table)</span></code></pre></div>
<table>
<caption>Anova Table (Type 3 tests)</caption>
<colgroup>
<col width="25%" />
<col width="11%" />
<col width="11%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">num Df</th>
<th align="center">den Df</th>
<th align="center">MSE</th>
<th align="center">F</th>
<th align="center">pes</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>group</strong></td>
<td align="center">1</td>
<td align="center">58</td>
<td align="center">131.8</td>
<td align="center">0.0114</td>
<td align="center">0.0001966</td>
<td align="center">0.9153</td>
</tr>
<tr class="even">
<td align="center"><strong>emotion</strong></td>
<td align="center">2</td>
<td align="center">116</td>
<td align="center">3.579</td>
<td align="center">4.001</td>
<td align="center">0.06452</td>
<td align="center">0.02089</td>
</tr>
<tr class="odd">
<td align="center"><strong>group:emotion</strong></td>
<td align="center">2</td>
<td align="center">116</td>
<td align="center">3.579</td>
<td align="center">3.556</td>
<td align="center">0.05777</td>
<td align="center">0.0317</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><em>Post-hoc tests</em></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="co"># Display post-hoc test results</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a><span class="kw">pander</span>(P3_amp_ph_all_emo)</span></code></pre></div>
<table>
<colgroup>
<col width="36%" />
<col width="15%" />
<col width="12%" />
<col width="8%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">contrast</th>
<th align="center">estimate</th>
<th align="center">SE</th>
<th align="center">df</th>
<th align="center">t.ratio</th>
<th align="center">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">P3_amp_hap - P3_amp_neu</td>
<td align="center">0.9278</td>
<td align="center">0.3454</td>
<td align="center">116</td>
<td align="center">2.686</td>
<td align="center">0.0224</td>
</tr>
<tr class="even">
<td align="center">P3_amp_hap - P3_amp_ang</td>
<td align="center">0.1989</td>
<td align="center">0.3454</td>
<td align="center">116</td>
<td align="center">0.5759</td>
<td align="center">0.8332</td>
</tr>
<tr class="odd">
<td align="center">P3_amp_neu - P3_amp_ang</td>
<td align="center">-0.7289</td>
<td align="center">0.3454</td>
<td align="center">116</td>
<td align="center">-2.11</td>
<td align="center">0.09214</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="co"># Display post-hoc test results</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a><span class="kw">pander</span>(P3_amp_ph_all_emo)</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="15%" />
<col width="17%" />
<col width="15%" />
<col width="10%" />
<col width="10%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">contrast</th>
<th align="center">emotion</th>
<th align="center">estimate</th>
<th align="center">SE</th>
<th align="center">df</th>
<th align="center">t.ratio</th>
<th align="center">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">CG - TG</td>
<td align="center">P3_amp_hap</td>
<td align="center">-1.11</td>
<td align="center">1.757</td>
<td align="center">64.38</td>
<td align="center">-0.6319</td>
<td align="center">0.5297</td>
</tr>
<tr class="even">
<td align="center">CG - TG</td>
<td align="center">P3_amp_neu</td>
<td align="center">-0.17</td>
<td align="center">1.757</td>
<td align="center">64.38</td>
<td align="center">-0.09673</td>
<td align="center">0.9232</td>
</tr>
<tr class="odd">
<td align="center">CG - TG</td>
<td align="center">P3_amp_ang</td>
<td align="center">0.732</td>
<td align="center">1.757</td>
<td align="center">64.38</td>
<td align="center">0.4166</td>
<td align="center">0.6783</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="co"># Display post-hoc test results</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a><span class="kw">pander</span>(P3_amp_ph_all_emo)</span></code></pre></div>
<table>
<colgroup>
<col width="32%" />
<col width="10%" />
<col width="13%" />
<col width="11%" />
<col width="7%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">contrast</th>
<th align="center">group</th>
<th align="center">estimate</th>
<th align="center">SE</th>
<th align="center">df</th>
<th align="center">t.ratio</th>
<th align="center">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">P3_amp_hap - P3_amp_neu</td>
<td align="center">CG</td>
<td align="center">0.4577</td>
<td align="center">0.4885</td>
<td align="center">116</td>
<td align="center">0.9371</td>
<td align="center">0.618</td>
</tr>
<tr class="even">
<td align="center">P3_amp_hap - P3_amp_ang</td>
<td align="center">CG</td>
<td align="center">-0.7222</td>
<td align="center">0.4885</td>
<td align="center">116</td>
<td align="center">-1.478</td>
<td align="center">0.305</td>
</tr>
<tr class="odd">
<td align="center">P3_amp_neu - P3_amp_ang</td>
<td align="center">CG</td>
<td align="center">-1.18</td>
<td align="center">0.4885</td>
<td align="center">116</td>
<td align="center">-2.415</td>
<td align="center">0.04518</td>
</tr>
<tr class="even">
<td align="center">P3_amp_hap - P3_amp_neu</td>
<td align="center">TG</td>
<td align="center">1.398</td>
<td align="center">0.4885</td>
<td align="center">116</td>
<td align="center">2.862</td>
<td align="center">0.01375</td>
</tr>
<tr class="odd">
<td align="center">P3_amp_hap - P3_amp_ang</td>
<td align="center">TG</td>
<td align="center">1.12</td>
<td align="center">0.4885</td>
<td align="center">116</td>
<td align="center">2.293</td>
<td align="center">0.06077</td>
</tr>
<tr class="even">
<td align="center">P3_amp_neu - P3_amp_ang</td>
<td align="center">TG</td>
<td align="center">-0.2779</td>
<td align="center">0.4885</td>
<td align="center">116</td>
<td align="center">-0.569</td>
<td align="center">0.8369</td>
</tr>
</tbody>
</table>
<p><em>Calculate separate model for each group</em></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a>P3_amp_all_emo_TG =<span class="st"> </span><span class="kw">subset</span>(P3_amp_all_emo, group <span class="op">==</span><span class="st"> &quot;TG&quot;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a>P3_amp_an_all_emo =<span class="st">  </span><span class="kw">aov_ez</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;amplitude&quot;</span>, P3_amp_all_emo_TG, <span class="dt">within =</span> <span class="kw">c</span>(<span class="st">&quot;emotion&quot;</span>),</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a>                     <span class="co"># covariate = c(&quot;mc_app_time&quot;,&quot;mc_CPM&quot;),</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a>                    <span class="co">#  observed = c(&quot;mc_app_time&quot;,&quot;mc_CPM&quot;), factorize = FALSE,</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true"></a>                   <span class="dt">anova_table =</span> <span class="kw">list</span>(<span class="dt">correction =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">es =</span> <span class="st">&quot;pes&quot;</span>))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true"></a><span class="kw">pander</span>(P3_amp_an_all_emo<span class="op">$</span>anova_table)</span></code></pre></div>
<table style="width:92%;">
<caption>Anova Table (Type 3 tests)</caption>
<colgroup>
<col width="19%" />
<col width="12%" />
<col width="12%" />
<col width="9%" />
<col width="11%" />
<col width="12%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">num Df</th>
<th align="center">den Df</th>
<th align="center">MSE</th>
<th align="center">F</th>
<th align="center">pes</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>emotion</strong></td>
<td align="center">2</td>
<td align="center">58</td>
<td align="center">3.82</td>
<td align="center">4.301</td>
<td align="center">0.1291</td>
<td align="center">0.01813</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a><span class="co"># Do post-hoc test </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a>  P3_amp_ph =<span class="st"> </span><span class="kw">emmeans</span>(P3_amp_an_all_emo, <span class="op">~</span><span class="st"> &quot;emotion&quot;</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true"></a>  P3_amp_ph_all_emo =<span class="st"> </span><span class="kw">print</span>(<span class="kw">pairs</span>(P3_amp_ph))</span></code></pre></div>
<p>contrast estimate SE df t.ratio p.value P3_amp_hap - P3_amp_neu 1.40 0.5 58 2.770 0.0200 P3_amp_hap - P3_amp_ang 1.12 0.5 58 2.220 0.0800 P3_amp_neu - P3_amp_ang -0.28 0.5 58 -0.550 0.8500</p>
<p>P value adjustment: tukey method for comparing a family of 3 estimates</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a>P3_amp_all_emo_CG =<span class="st"> </span><span class="kw">subset</span>(P3_amp_all_emo, group <span class="op">==</span><span class="st"> &quot;CG&quot;</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true"></a>P3_amp_an_all_emo =<span class="st">  </span><span class="kw">aov_ez</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;amplitude&quot;</span>, P3_amp_all_emo_CG, <span class="dt">within =</span> <span class="kw">c</span>(<span class="st">&quot;emotion&quot;</span>),</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true"></a>                     <span class="co"># covariate = c(&quot;mc_app_time&quot;,&quot;mc_CPM&quot;),</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true"></a>                    <span class="co">#  observed = c(&quot;mc_app_time&quot;,&quot;mc_CPM&quot;), factorize = FALSE,</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true"></a>                   <span class="dt">anova_table =</span> <span class="kw">list</span>(<span class="dt">correction =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">es =</span> <span class="st">&quot;pes&quot;</span>))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true"></a><span class="kw">pander</span>(P3_amp_an_all_emo<span class="op">$</span>anova_table)</span></code></pre></div>
<table style="width:93%;">
<caption>Anova Table (Type 3 tests)</caption>
<colgroup>
<col width="19%" />
<col width="12%" />
<col width="12%" />
<col width="11%" />
<col width="9%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">num Df</th>
<th align="center">den Df</th>
<th align="center">MSE</th>
<th align="center">F</th>
<th align="center">pes</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>emotion</strong></td>
<td align="center">2</td>
<td align="center">58</td>
<td align="center">3.338</td>
<td align="center">3.18</td>
<td align="center">0.09883</td>
<td align="center">0.04891</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a><span class="co"># Do post-hoc test </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a>  P3_amp_ph =<span class="st"> </span><span class="kw">emmeans</span>(P3_amp_an_all_emo, <span class="op">~</span><span class="st"> &quot;emotion&quot;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true"></a>  P3_amp_ph_all_emo =<span class="st"> </span><span class="kw">print</span>(<span class="kw">pairs</span>(P3_amp_ph))</span></code></pre></div>
<p>contrast estimate SE df t.ratio p.value P3_amp_hap - P3_amp_neu 0.46 0.47 58 0.970 0.6000 P3_amp_hap - P3_amp_ang -0.72 0.47 58 -1.530 0.2800 P3_amp_neu - P3_amp_ang -1.18 0.47 58 -2.500 0.0400</p>
<p>P value adjustment: tukey method for comparing a family of 3 estimates</p>
<p><strong>P3 differ between emotional vs.neutral faces</strong></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a>  P3_amp_an_emo_neu =<span class="st">  </span><span class="kw">aov_ez</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;amplitude&quot;</span>, P3_amp_emo_neu, <span class="dt">within =</span> <span class="kw">c</span>(<span class="st">&quot;emotion&quot;</span>), <span class="dt">between =</span> <span class="kw">c</span>(<span class="st">&quot;group&quot;</span>),</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a>                      <span class="co">#covariate = c(&quot;mc_app_time&quot;,&quot;mc_CPM&quot;),</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a>                      <span class="co">#observed = c(&quot;mc_app_time&quot;,&quot;mc_CPM&quot;), factorize = FALSE,</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true"></a>                   <span class="dt">anova_table =</span> <span class="kw">list</span>(<span class="dt">correction =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">es =</span> <span class="st">&quot;pes&quot;</span>))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true"></a>  <span class="kw">pander</span>(P3_amp_an_emo_neu<span class="op">$</span>anova_table)</span></code></pre></div>
<table>
<caption>Anova Table (Type 3 tests)</caption>
<colgroup>
<col width="24%" />
<col width="10%" />
<col width="10%" />
<col width="9%" />
<col width="13%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">num Df</th>
<th align="center">den Df</th>
<th align="center">MSE</th>
<th align="center">F</th>
<th align="center">pes</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>group</strong></td>
<td align="center">1</td>
<td align="center">58</td>
<td align="center">87.7</td>
<td align="center">0.01102</td>
<td align="center">0.00019</td>
<td align="center">0.9167</td>
</tr>
<tr class="even">
<td align="center"><strong>emotion</strong></td>
<td align="center">1</td>
<td align="center">58</td>
<td align="center">2.371</td>
<td align="center">8.683</td>
<td align="center">0.1302</td>
<td align="center">0.004618</td>
</tr>
<tr class="odd">
<td align="center"><strong>group:emotion</strong></td>
<td align="center">1</td>
<td align="center">58</td>
<td align="center">2.371</td>
<td align="center">0.001159</td>
<td align="center">0.00001998</td>
<td align="center">0.973</td>
</tr>
</tbody>
</table>
<p><em>Post-hoc tests</em></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a><span class="co"># Display post-hoc test results</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a><span class="kw">pander</span>(P3_amp_ph_emo_neu)</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="36%" />
<col width="15%" />
<col width="12%" />
<col width="6%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">contrast</th>
<th align="center">estimate</th>
<th align="center">SE</th>
<th align="center">df</th>
<th align="center">t.ratio</th>
<th align="center">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">P3_amp_neu - P3_amp_emo</td>
<td align="center">-0.8284</td>
<td align="center">0.2811</td>
<td align="center">58</td>
<td align="center">-2.947</td>
<td align="center">0.004618</td>
</tr>
</tbody>
</table>
</div>
<div id="lmms" class="section level2">
<h2>LMMs</h2>
<!-- Load and prepare data sets -->
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a><span class="co">##### P1</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true"></a><span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true"></a>P1_stat<span class="op">$</span>ID =<span class="st"> </span><span class="kw">factor</span>(P1_stat<span class="op">$</span>ID)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true"></a>P1_stat<span class="op">$</span>stim_ID =<span class="st"> </span><span class="kw">factor</span>(P1_stat<span class="op">$</span>stim_ID)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true"></a><span class="co"># Factor and level emotion</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true"></a>P1_stat<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(P1_stat<span class="op">$</span>emotion, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true"></a><span class="co"># Factor and level group</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true"></a>P1_stat<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(P1_stat<span class="op">$</span>group, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;CG&quot;</span>, <span class="st">&quot;TG&quot;</span>))</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true"></a><span class="co"># Define effect coding contrast for group and emotion</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_stat<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_stat<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true"></a><span class="co">##### N170</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true"></a><span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true"></a>N170_stat<span class="op">$</span>ID =<span class="st"> </span><span class="kw">factor</span>(N170_stat<span class="op">$</span>ID)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true"></a>N170_stat<span class="op">$</span>stim_ID =<span class="st"> </span><span class="kw">factor</span>(N170_stat<span class="op">$</span>stim_ID)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true"></a>N170_stat<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(N170_stat<span class="op">$</span>group)</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true"></a></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true"></a><span class="co"># Factor and level emotion</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true"></a>N170_stat<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(N170_stat<span class="op">$</span>emotion, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true"></a></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true"></a><span class="co"># Factor and level group</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true"></a>N170_stat<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(N170_stat<span class="op">$</span>group, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;CG&quot;</span>, <span class="st">&quot;TG&quot;</span>))</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true"></a></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true"></a><span class="co"># Define effect coding contrast for group and emotion</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_stat<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_stat<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true"></a></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true"></a><span class="co"># Re-name and factor hemisphere</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true"></a>N170_stat<span class="op">$</span>hem =<span class="st"> </span><span class="kw">factor</span>(N170_stat<span class="op">$</span>hem, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;right&quot;</span>))</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_stat<span class="op">$</span>hem) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true"></a></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true"></a><span class="co">##### P3</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true"></a></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true"></a><span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true"></a>P3_short_stat<span class="op">$</span>ID =<span class="st"> </span><span class="kw">factor</span>(P3_short_stat<span class="op">$</span>ID)</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true"></a>P3_short_stat<span class="op">$</span>stim_ID =<span class="st"> </span><span class="kw">factor</span>(P3_short_stat<span class="op">$</span>stim_ID)</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true"></a></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true"></a><span class="co"># Factor and level emotion</span></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true"></a>P3_short_stat<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(P3_short_stat<span class="op">$</span>emotion, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;happy&quot;</span>, </span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true"></a>    <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true"></a></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true"></a><span class="co"># Factor and level group</span></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true"></a>P3_short_stat<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(P3_short_stat<span class="op">$</span>group, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;CG&quot;</span>, <span class="st">&quot;TG&quot;</span>))</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true"></a></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true"></a><span class="co"># Define effect coding contrast for group and emotion</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_short_stat<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_short_stat<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)</span></code></pre></div>
<div id="assumption-checks" class="section level3 tabset tabset-pills">
<h3 class="tabset tabset-pills">Assumption checks</h3>
<div id="lmm_p1-normality-of-residuals" class="section level4">
<h4>LMM_P1: Normality of residuals</h4>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a><span class="cf">if</span> (lmm <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true"></a>    <span class="co"># Visualize normality assumption of residuals</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true"></a>    mod_P1 =<span class="st"> </span><span class="kw">lm</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>group <span class="op">*</span><span class="st"> </span>emotion, <span class="dt">data =</span> P1_stat)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true"></a>    </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true"></a>    res.mod_P1 =<span class="st"> </span><span class="kw">residuals</span>(mod_P1)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true"></a>    </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true"></a>    <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true"></a>    qqpl_mod_P1 =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P1, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true"></a>    norm_mod_P1 =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P1), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true"></a>    <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true"></a>}</span></code></pre></div>
</div>
<div id="lmm_p1-random-effect-structure" class="section level4">
<h4>LMM_P1: Random effect structure</h4>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true"></a><span class="cf">if</span> (lmm <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true"></a>    </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true"></a>    <span class="co"># Add contrast columns</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true"></a>    mm_P1 =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>emotion <span class="op">*</span><span class="st"> </span>group, P1_stat)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true"></a>    </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true"></a>    <span class="co"># Attach to dataframe</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true"></a>    P1_stat[, (<span class="kw">ncol</span>(P1_stat) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P1_stat) <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)] =<span class="st"> </span>mm_P1</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true"></a>    <span class="kw">names</span>(P1_stat)[(<span class="kw">ncol</span>(P1_stat) <span class="op">-</span><span class="st"> </span><span class="dv">5</span>)<span class="op">:</span><span class="kw">ncol</span>(P1_stat)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Neu_Hap&quot;</span>, <span class="st">&quot;Neu_Ang&quot;</span>, </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true"></a>        <span class="st">&quot;Training&quot;</span>, <span class="st">&quot;Train_Neu_Hap&quot;</span>, <span class="st">&quot;Train_Neu_Ang&quot;</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true"></a>    </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true"></a>    <span class="co"># Build model</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true"></a>    mod_P1_lmer1 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P1_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true"></a>    </span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true"></a>    <span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true"></a>    <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P1_lmer1))</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true"></a>    </span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true"></a>    <span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true"></a>    <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P1_lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true"></a>    </span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true"></a>    <span class="co"># Build full model</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true"></a>    mod_P1_lmer2 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true"></a><span class="st">        </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P1_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true"></a>    </span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true"></a>    <span class="co"># Likelihood ratio testing</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true"></a>    </span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true"></a>    <span class="co"># For ID</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true"></a>    mod_P1_lmer3 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P1_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true"></a>    </span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true"></a>    <span class="kw">anova</span>(mod_P1_lmer2, mod_P1_lmer3)</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true"></a>    </span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true"></a>    <span class="co"># For stim_ID</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true"></a>    mod_P1_lmer4 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true"></a><span class="st">        </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P1_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true"></a>    </span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true"></a>    </span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true"></a>    <span class="kw">anova</span>(mod_P1_lmer2, mod_P1_lmer4)</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true"></a>    </span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true"></a>    </span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true"></a>    <span class="co"># Final model</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true"></a>    mod_P1_lmer5 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P1_stat, </span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true"></a>        <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true"></a>    </span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true"></a>}</span></code></pre></div>
<!-- P1 model without covariates  -->
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a>mod_P1_lmer5 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P1_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true"></a>    <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<!-- Contrast for pooled emotions  -->
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a><span class="co"># Create contrast which pools happy/ angry facial expressions</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true"></a>contrasts =<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true"></a><span class="co"># Build model and add individualized contrast</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true"></a>mod_P1_lmer1 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>emotion <span class="op">*</span><span class="st"> </span>group <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P1_stat, <span class="dt">contrasts =</span> <span class="kw">list</span>(<span class="dt">emotion =</span> contrasts), <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true"></a>    <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true"></a><span class="kw">tab_model</span>(mod_P1_lmer1)</span></code></pre></div>
<p><br></p>
</div>
<div id="lmm_p1-homoscedasticity" class="section level4">
<h4>LMM_P1: Homoscedasticity</h4>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a><span class="cf">if</span> (lmm <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true"></a>    </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true"></a>    </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true"></a>    <span class="co"># Whether residuals are equally distributed along regression line</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true"></a>    <span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P1_lmer5), <span class="kw">residuals</span>(mod_P1_lmer5))</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true"></a>    <span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true"></a>    </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true"></a>}</span></code></pre></div>
<p><br></p>
</div>
<div id="lmm_n170-normality-of-residuals" class="section level4">
<h4>LMM_N170: Normality of residuals</h4>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true"></a><span class="cf">if</span> (lmm <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true"></a>    </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true"></a>    <span class="co"># Visualize normality assumption of residuals</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true"></a>    mod_N170 =<span class="st"> </span><span class="kw">lm</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>group <span class="op">*</span><span class="st"> </span>emotion, <span class="dt">data =</span> N170_stat)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true"></a>    </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true"></a>    res.mod_N170 =<span class="st"> </span><span class="kw">residuals</span>(mod_N170)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true"></a>    </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true"></a>    <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true"></a>    qqpl_mod_N170 =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_N170, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true"></a>    norm_mod_N170 =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_N170), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true"></a>    <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true"></a>    </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true"></a>}</span></code></pre></div>
</div>
<div id="lmm_n170-random-effect-structure" class="section level4">
<h4>LMM_N170: Random effect structure</h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true"></a><span class="cf">if</span> (lmm <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true"></a>    </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true"></a>    <span class="co"># Add contrast columns</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true"></a>    mm_N170 =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>emotion <span class="op">*</span><span class="st"> </span>group <span class="op">+</span><span class="st"> </span>hem, N170_stat)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true"></a>    </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true"></a>    <span class="co"># Attach to dataframe</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true"></a>    N170_stat[, (<span class="kw">ncol</span>(N170_stat) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(N170_stat) <span class="op">+</span><span class="st"> </span><span class="dv">7</span>)] =<span class="st"> </span>mm_N170</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true"></a>    <span class="kw">names</span>(N170_stat)[(<span class="kw">ncol</span>(N170_stat) <span class="op">-</span><span class="st"> </span><span class="dv">6</span>)<span class="op">:</span><span class="kw">ncol</span>(N170_stat)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Neu_Hap&quot;</span>, </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true"></a>        <span class="st">&quot;Neu_Ang&quot;</span>, <span class="st">&quot;LvR&quot;</span>, <span class="st">&quot;Training&quot;</span>, <span class="st">&quot;Train_Neu_Hap&quot;</span>, <span class="st">&quot;Train_Neu_Ang&quot;</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true"></a>    </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true"></a>    <span class="co"># Build model</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true"></a>    mod_N170_lmer1 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>LvR <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>LvR <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true"></a><span class="st">        </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true"></a><span class="st">        </span>LvR <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> N170_stat, </span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true"></a>        <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true"></a>    </span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true"></a>    <span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true"></a>    <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_N170_lmer1))</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true"></a>    </span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true"></a>    <span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true"></a>    <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_N170_lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true"></a>    </span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true"></a>    <span class="co"># Build model</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true"></a>    mod_N170_lmer2 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>LvR <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>LvR <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true"></a><span class="st">        </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>LvR <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>stim_ID), </span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true"></a>        <span class="dt">data =</span> N170_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true"></a>    </span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true"></a>    <span class="co"># Likelihood ratio testing</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true"></a>    </span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true"></a>    <span class="co"># For ID</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true"></a>    mod_N170_lmer3 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>LvR <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true"></a><span class="st">        </span>LvR <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> N170_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true"></a>    </span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true"></a>    </span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true"></a>    <span class="kw">anova</span>(mod_N170_lmer2, mod_N170_lmer3)</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true"></a>    </span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true"></a>    <span class="co"># For stim_ID</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true"></a>    mod_N170_lmer4 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>LvR <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>LvR <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true"></a><span class="st">        </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> N170_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true"></a>    </span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true"></a>    <span class="kw">anova</span>(mod_N170_lmer2, mod_N170_lmer4)</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true"></a>    </span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true"></a>    <span class="co"># Final model</span></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true"></a>    mod_N170_lmer5 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>LvR <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>LvR <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true"></a><span class="st">        </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>LvR <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>stim_ID), </span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true"></a>        <span class="dt">data =</span> N170_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true"></a>    </span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true"></a>}</span></code></pre></div>
</div>
<div id="lmm_n170-homoscedasticity" class="section level4">
<h4>LMM_N170: Homoscedasticity</h4>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true"></a><span class="cf">if</span> (lmm <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true"></a>    </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true"></a>    <span class="co"># Whether residuals are equally distributed along regression line</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true"></a>    <span class="kw">plot</span>(<span class="kw">fitted</span>(mod_N170_lmer5), <span class="kw">residuals</span>(mod_N170_lmer5))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true"></a>    <span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true"></a>}</span></code></pre></div>
</div>
<div id="lmm_p3-normality-of-residuals" class="section level4">
<h4>LMM_P3: Normality of residuals</h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true"></a><span class="cf">if</span> (lmm <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true"></a>    </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true"></a>    <span class="co"># Visualize normality assumption of residuals</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true"></a>    mod_P3 =<span class="st"> </span><span class="kw">lm</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>group <span class="op">*</span><span class="st"> </span>emotion, <span class="dt">data =</span> P3_short_stat)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true"></a>    </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true"></a>    res.mod_P3 =<span class="st"> </span><span class="kw">residuals</span>(mod_P3)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true"></a>    </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true"></a>    <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true"></a>    qqpl_mod_P3 =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P3, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true"></a>    norm_mod_P3 =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P3), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true"></a>    <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true"></a>    </span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true"></a>}</span></code></pre></div>
</div>
<div id="lmm_p3-random-effect-structure" class="section level4">
<h4>LMM_P3: Random effect structure</h4>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true"></a><span class="cf">if</span> (lmm <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true"></a>    </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true"></a>    <span class="co"># Add contrast columns</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true"></a>    mm_P3 =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>emotion <span class="op">*</span><span class="st"> </span>group, P3_short_stat)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true"></a>    </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true"></a>    <span class="co"># Attach to dataframe</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true"></a>    P3_short_stat[, (<span class="kw">ncol</span>(P3_short_stat) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P3_short_stat) <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)] =<span class="st"> </span>mm_P3</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true"></a>    <span class="kw">names</span>(P3_short_stat)[(<span class="kw">ncol</span>(P3_short_stat) <span class="op">-</span><span class="st"> </span><span class="dv">5</span>)<span class="op">:</span><span class="kw">ncol</span>(P3_short_stat)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true"></a>        <span class="st">&quot;Neu_Hap&quot;</span>, <span class="st">&quot;Neu_Ang&quot;</span>, <span class="st">&quot;Training&quot;</span>, <span class="st">&quot;Train_Neu_Hap&quot;</span>, <span class="st">&quot;Train_Neu_Ang&quot;</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true"></a>    </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true"></a>    <span class="co"># Build model</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true"></a>    mod_P3_lmer1 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P3_short_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true"></a>    </span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true"></a>    <span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true"></a>    <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P3_lmer1))</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true"></a>    </span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true"></a>    <span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true"></a>    <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P3_lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true"></a>    </span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true"></a>    <span class="co"># Build model</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true"></a>    mod_P3_lmer2 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Training <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true"></a><span class="st">        </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P3_short_stat, </span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true"></a>        <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true"></a>    </span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true"></a>    </span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true"></a>    <span class="co"># Likelihood ratio testing</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true"></a>    </span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true"></a>    <span class="co"># For ID</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true"></a>    mod_P3_lmer3 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true"></a><span class="st">        </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P3_short_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true"></a>    </span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true"></a>    <span class="kw">anova</span>(mod_P3_lmer2, mod_P3_lmer3)</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true"></a>    </span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true"></a>    <span class="co"># For stim_ID</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true"></a>    mod_P3_lmer4 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Training <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true"></a><span class="st">        </span>stim_ID), <span class="dt">data =</span> P3_short_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true"></a>    </span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true"></a>    <span class="kw">anova</span>(mod_P3_lmer2, mod_P3_lmer4)</span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true"></a>    </span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true"></a>    <span class="co"># Final model</span></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true"></a>    mod_P3_lmer5 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true"></a><span class="st">        </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P3_short_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true"></a>    </span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true"></a>}</span></code></pre></div>
</div>
<div id="lmm_p3-homoscedasticity" class="section level4">
<h4>LMM_P3: Homoscedasticity</h4>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true"></a><span class="cf">if</span> (lmm <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true"></a>    </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true"></a>    <span class="co"># Whether residuals are equally distributed along regression line</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true"></a>    <span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P3_lmer5), <span class="kw">residuals</span>(mod_P3_lmer5))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true"></a>    <span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true"></a>}</span></code></pre></div>
</div>
</div>
<div id="results" class="section level3">
<h3>Results</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true"></a><span class="cf">if</span> (lmm <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true"></a> <span class="co"># Create table</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true"></a>  <span class="kw">tab_model</span>(mod_P1_lmer5, mod_N170_lmer5, mod_P3_lmer5,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true"></a>                <span class="co">#pred.labels=labels,</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true"></a>                <span class="dt">show.se=</span><span class="ot">TRUE</span>, <span class="dt">show.stat=</span><span class="ot">TRUE</span>, <span class="dt">show.ci =</span> <span class="ot">FALSE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true"></a>                <span class="dt">show.re.var=</span><span class="ot">FALSE</span>, <span class="dt">show.obs=</span><span class="ot">FALSE</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true"></a>                <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, <span class="dt">dv.labels=</span><span class="kw">c</span>(<span class="st">&quot;P1 Amplitudes&quot;</span>,<span class="st">&quot;N170 Amplitudes&quot;</span>,<span class="st">&quot;P3 Amplitudes&quot;</span>),</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true"></a>                <span class="dt">show.icc =</span> <span class="ot">FALSE</span>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true"></a>}</span></code></pre></div>
</div>
<div id="p3---different-time-windows" class="section level3 tabset tabset-pills">
<h3 class="tabset tabset-pills">P3 - Different time windows</h3>
</div>
<div id="lmm_300_400_res" class="section level3">
<h3>LMM_300_400_RES</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true"></a><span class="cf">if</span> (lmm <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true"></a>    </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true"></a>    <span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true"></a>    P3_short_stat<span class="op">$</span>ID =<span class="st"> </span><span class="kw">factor</span>(P3_short_stat<span class="op">$</span>ID)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true"></a>    P3_short_stat<span class="op">$</span>stim_ID =<span class="st"> </span><span class="kw">factor</span>(P3_short_stat<span class="op">$</span>stim_ID)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true"></a>    </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true"></a>    <span class="co"># Factor and level emotion</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true"></a>    P3_short_stat<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(P3_short_stat<span class="op">$</span>emotion, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;happy&quot;</span>, </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true"></a>        <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true"></a>    </span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true"></a>    <span class="co"># Factor and level group</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true"></a>    P3_short_stat<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(P3_short_stat<span class="op">$</span>group, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;CG&quot;</span>, <span class="st">&quot;TG&quot;</span>))</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true"></a>    </span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true"></a>    <span class="co"># Define effect coding contrast for group and emotion</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true"></a>    <span class="kw">contrasts</span>(P3_short_stat<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true"></a>    <span class="kw">contrasts</span>(P3_short_stat<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true"></a>    </span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true"></a>    </span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true"></a>    <span class="co"># Add contrast columns</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true"></a>    mm_P3 =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>emotion <span class="op">*</span><span class="st"> </span>group, P3_short_stat)</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true"></a>    </span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true"></a>    <span class="co"># Attach to dataframe</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true"></a>    P3_short_stat[, (<span class="kw">ncol</span>(P3_short_stat) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P3_short_stat) <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)] =<span class="st"> </span>mm_P3</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true"></a>    <span class="kw">names</span>(P3_short_stat)[(<span class="kw">ncol</span>(P3_short_stat) <span class="op">-</span><span class="st"> </span><span class="dv">5</span>)<span class="op">:</span><span class="kw">ncol</span>(P3_short_stat)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, </span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true"></a>        <span class="st">&quot;Neu_Hap&quot;</span>, <span class="st">&quot;Neu_Ang&quot;</span>, <span class="st">&quot;Training&quot;</span>, <span class="st">&quot;Train_Neu_Hap&quot;</span>, <span class="st">&quot;Train_Neu_Ang&quot;</span>)</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true"></a>    </span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true"></a>    <span class="co"># Build model</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true"></a>    mod_P3_short_lmer1 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P3_short_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true"></a>    </span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true"></a>    <span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true"></a>    <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P3_short_lmer1))</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true"></a>    </span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true"></a>    <span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true"></a>    <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P3_short_lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true"></a>    </span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true"></a>    <span class="co"># Build model</span></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true"></a>    mod_P3_short_lmer2 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Training <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true"></a><span class="st">        </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P3_short_stat, </span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true"></a>        <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true"></a>    </span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true"></a>    </span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true"></a>    <span class="co"># Likelihood ratio testing</span></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true"></a>    </span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true"></a>    <span class="co"># For ID</span></span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true"></a>    mod_P3_short_lmer3 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true"></a><span class="st">        </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P3_short_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true"></a>    </span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true"></a>    <span class="kw">anova</span>(mod_P3_short_lmer2, mod_P3_short_lmer3)</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true"></a>    </span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true"></a>    <span class="co"># For stim_ID</span></span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true"></a>    mod_P3_short_lmer4 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Training <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true"></a><span class="st">        </span>stim_ID), <span class="dt">data =</span> P3_short_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true"></a>    </span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true"></a>    <span class="kw">anova</span>(mod_P3_short_lmer2, mod_P3_short_lmer4)</span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true"></a>    </span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true"></a>    <span class="co"># Final model</span></span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true"></a>    mod_P3_short_lmer5 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true"></a><span class="st">        </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P3_short_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true"></a>}</span></code></pre></div>
</div>
<div id="lmm_300_500_res" class="section level3">
<h3>LMM_300_500_RES</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true"></a><span class="cf">if</span> (lmm <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true"></a>    </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true"></a>    <span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true"></a>    P3_medium_stat<span class="op">$</span>ID =<span class="st"> </span><span class="kw">factor</span>(P3_medium_stat<span class="op">$</span>ID)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true"></a>    P3_medium_stat<span class="op">$</span>stim_ID =<span class="st"> </span><span class="kw">factor</span>(P3_medium_stat<span class="op">$</span>stim_ID)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true"></a>    </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true"></a>    <span class="co"># Factor and level emotion</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true"></a>    P3_medium_stat<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(P3_medium_stat<span class="op">$</span>emotion, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true"></a>        <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true"></a>    </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true"></a>    <span class="co"># Factor and level group</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true"></a>    P3_medium_stat<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(P3_medium_stat<span class="op">$</span>group, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;CG&quot;</span>, <span class="st">&quot;TG&quot;</span>))</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true"></a>    </span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true"></a>    <span class="co"># Define effect coding contrast for group and emotion</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true"></a>    <span class="kw">contrasts</span>(P3_medium_stat<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true"></a>    <span class="kw">contrasts</span>(P3_medium_stat<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true"></a>    </span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true"></a>    </span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true"></a>    <span class="co"># Add contrast columns</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true"></a>    mm_P3 =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>emotion <span class="op">*</span><span class="st"> </span>group, P3_medium_stat)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true"></a>    </span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true"></a>    <span class="co"># Attach to dataframe</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true"></a>    P3_medium_stat[, (<span class="kw">ncol</span>(P3_medium_stat) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P3_medium_stat) <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)] =<span class="st"> </span>mm_P3</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true"></a>    <span class="kw">names</span>(P3_medium_stat)[(<span class="kw">ncol</span>(P3_medium_stat) <span class="op">-</span><span class="st"> </span><span class="dv">5</span>)<span class="op">:</span><span class="kw">ncol</span>(P3_medium_stat)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, </span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true"></a>        <span class="st">&quot;Neu_Hap&quot;</span>, <span class="st">&quot;Neu_Ang&quot;</span>, <span class="st">&quot;Training&quot;</span>, <span class="st">&quot;Train_Neu_Hap&quot;</span>, <span class="st">&quot;Train_Neu_Ang&quot;</span>)</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true"></a>    </span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true"></a>    <span class="co"># Build model</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true"></a>    mod_P3_medium_lmer1 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P3_medium_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true"></a>    </span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true"></a>    <span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true"></a>    <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P3_medium_lmer1))</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true"></a>    </span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true"></a>    <span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true"></a>    <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P3_medium_lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true"></a>    </span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true"></a>    <span class="co"># Build model</span></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true"></a>    mod_P3_medium_lmer2 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Training <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true"></a><span class="st">        </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P3_medium_stat, </span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true"></a>        <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true"></a>    </span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true"></a>    </span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true"></a>    <span class="co"># Likelihood ratio testing</span></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true"></a>    </span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true"></a>    <span class="co"># For ID</span></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true"></a>    mod_P3_medium_lmer3 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true"></a><span class="st">        </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P3_medium_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true"></a>    </span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true"></a>    <span class="kw">anova</span>(mod_P3_medium_lmer2, mod_P3_medium_lmer3)</span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true"></a>    </span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true"></a>    <span class="co"># For stim_ID</span></span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true"></a>    mod_P3_medium_lmer4 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Training <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true"></a><span class="st">        </span>stim_ID), <span class="dt">data =</span> P3_medium_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true"></a>    </span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true"></a>    <span class="kw">anova</span>(mod_P3_medium_lmer2, mod_P3_medium_lmer4)</span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true"></a>    </span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true"></a>    <span class="co"># Final model</span></span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true"></a>    mod_P3_medium_lmer5 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true"></a><span class="st">        </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P3_medium_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true"></a>}</span></code></pre></div>
</div>
<div id="lmm_300_600_res" class="section level3">
<h3>LMM_300_600_RES</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true"></a><span class="cf">if</span> (lmm <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true"></a>    </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true"></a>    <span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true"></a>    P3_long_stat<span class="op">$</span>ID =<span class="st"> </span><span class="kw">factor</span>(P3_long_stat<span class="op">$</span>ID)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true"></a>    P3_long_stat<span class="op">$</span>stim_ID =<span class="st"> </span><span class="kw">factor</span>(P3_long_stat<span class="op">$</span>stim_ID)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true"></a>    </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true"></a>    <span class="co"># Factor and level emotion</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true"></a>    P3_long_stat<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(P3_long_stat<span class="op">$</span>emotion, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;happy&quot;</span>, </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true"></a>        <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true"></a>    </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true"></a>    <span class="co"># Factor and level group</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true"></a>    P3_long_stat<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(P3_long_stat<span class="op">$</span>group, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;CG&quot;</span>, <span class="st">&quot;TG&quot;</span>))</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true"></a>    </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true"></a>    <span class="co"># Define effect coding contrast for group and emotion</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true"></a>    <span class="kw">contrasts</span>(P3_long_stat<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true"></a>    <span class="kw">contrasts</span>(P3_long_stat<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true"></a>    </span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true"></a>    </span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true"></a>    <span class="co"># Add contrast columns</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true"></a>    mm_P3 =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>emotion <span class="op">*</span><span class="st"> </span>group, P3_long_stat)</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true"></a>    </span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true"></a>    <span class="co"># Attach to dataframe</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true"></a>    P3_long_stat[, (<span class="kw">ncol</span>(P3_long_stat) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P3_long_stat) <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)] =<span class="st"> </span>mm_P3</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true"></a>    <span class="kw">names</span>(P3_long_stat)[(<span class="kw">ncol</span>(P3_long_stat) <span class="op">-</span><span class="st"> </span><span class="dv">5</span>)<span class="op">:</span><span class="kw">ncol</span>(P3_long_stat)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, </span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true"></a>        <span class="st">&quot;Neu_Hap&quot;</span>, <span class="st">&quot;Neu_Ang&quot;</span>, <span class="st">&quot;Training&quot;</span>, <span class="st">&quot;Train_Neu_Hap&quot;</span>, <span class="st">&quot;Train_Neu_Ang&quot;</span>)</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true"></a>    </span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true"></a>    <span class="co"># Build model</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true"></a>    mod_P3_long_lmer1 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span>Train_Neu_Ang <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P3_long_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true"></a>    </span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true"></a>    <span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true"></a>    <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P3_long_lmer1))</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true"></a>    </span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true"></a>    <span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true"></a>    <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P3_long_lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true"></a>    </span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true"></a>    <span class="co"># Build model</span></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true"></a>    mod_P3_long_lmer2 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Training <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true"></a><span class="st">        </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P3_long_stat, </span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true"></a>        <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true"></a>    </span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true"></a>    </span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true"></a>    <span class="co"># Likelihood ratio testing</span></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true"></a>    </span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true"></a>    <span class="co"># For ID</span></span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true"></a>    mod_P3_long_lmer3 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true"></a><span class="st">        </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P3_long_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true"></a>    </span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true"></a>    <span class="kw">anova</span>(mod_P3_long_lmer2, mod_P3_long_lmer3)</span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true"></a>    </span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true"></a>    <span class="co"># For stim_ID</span></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true"></a>    mod_P3_long_lmer4 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Training <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true"></a><span class="st">        </span>stim_ID), <span class="dt">data =</span> P3_long_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true"></a>    </span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true"></a>    <span class="kw">anova</span>(mod_P3_long_lmer2, mod_P3_long_lmer4)</span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true"></a>    </span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true"></a>    <span class="co"># Final model</span></span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true"></a>    mod_P3_long_lmer5 =<span class="st"> </span><span class="kw">lmer</span>(ROI_GA_amp <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true"></a><span class="st">        </span>Train_Neu_Ang <span class="op">+</span><span class="st"> </span>z_app_time <span class="op">+</span><span class="st"> </span>z_age <span class="op">+</span><span class="st"> </span>z_CPM <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true"></a><span class="st">        </span>Training <span class="op">+</span><span class="st"> </span>Train_Neu_Hap <span class="op">||</span><span class="st"> </span>stim_ID), <span class="dt">data =</span> P3_long_stat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true"></a>        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb46-70"><a href="#cb46-70" aria-hidden="true"></a>}</span></code></pre></div>
</div>
<div id="results-1" class="section level3">
<h3>Results</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true"></a><span class="cf">if</span> (lmm <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true"></a> <span class="co"># Create table</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true"></a>  <span class="kw">tab_model</span>(mod_P3_short_lmer5, mod_P3_medium_lmer5, mod_P3_long_lmer5,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true"></a>                <span class="co">#pred.labels=labels,</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true"></a>                <span class="dt">show.se=</span><span class="ot">TRUE</span>, <span class="dt">show.stat=</span><span class="ot">TRUE</span>, <span class="dt">show.ci =</span> <span class="ot">FALSE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true"></a>                <span class="dt">show.re.var=</span><span class="ot">FALSE</span>, <span class="dt">show.obs=</span><span class="ot">FALSE</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true"></a>                <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, <span class="dt">dv.labels=</span><span class="kw">c</span>(<span class="st">&quot;P3: 300-400 ms&quot;</span>,<span class="st">&quot;P3: 300-500 ms&quot;</span>,<span class="st">&quot;P3: 300-600 ms&quot;</span>),</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true"></a>                <span class="dt">show.icc =</span> <span class="ot">FALSE</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true"></a>}</span></code></pre></div>
</div>
</div>
</div>

    </div>
    <div class="col-xs-2">
        <div class="btn-toolbar">
    <div class="btn-group">
    <a href="#" class="btn btn-raised btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="text-muted">Code</span> <span class="text-muted caret"></span></a>
    <ul class="dropdown-menu" style="min-width: 50px;">
    <li><a id="rmd-show-all-code" href="#">Show All</a></li>
    <li><a id="rmd-hide-all-code" href="#">Hide All</a></li>
    </ul>
    </div>
    </div>
        </div>
  </div>
  </div>
  </div>
  <div class="row">
    </div>
  </div>

<script>
$(document).ready(function () {
  // add bootstrap table styles to pandoc tables
  $('tr.header').parent('thead').parent('table').addClass('table table-striped table-hover');

  
    $('.pages img')
 	  .addClass("image-lb");
  $('.pages').magnificPopup({
	      type:'image',
	      closeOnContentClick: false,
	      closeBtnInside: false,
        delegate: 'img',
	      gallery: {enabled: true },
          removalDelay: 500,
          callbacks: {
              beforeOpen: function() {
                // just a hack that adds mfp-anim class to markup
                this.st.image.markup = this.st.image.markup.replace('mfp-figure', 'mfp-figure mfp-with-anim');
              }
          },
          mainClass: 'mfp-move-from-top',
	      image: {
	        verticalFit: true,
            titleSrc: 'alt'
	      }
 	    });
 	
    
    $('#toc ul li').first().addClass("active");
    $('#toc ul li').attr("data-target", function() {
        return($(this).children("a").attr("href"));
    })
    $('body .section.level1').first().addClass("active");
    $('body .section.level1').not('.active').hide();
    
    $('#toc a[href*="#"]').click(function() {

      var id = $(this).attr("href");
      if (id === "#") return;
      if (id.substring(0, 8) === "#dyntab-") return;
      toggle_page(id);

      // Menu
      var menu_entry = $(".menu li[data-target='"+id+"']");
      menu_entry.addClass("active");
      $(".menu li").not(menu_entry).removeClass("active"); 
      

    });

    function toggle_page(id) {
      $(".page").not(page).removeClass("active").hide();
      window.page = id;
      var page = $(window.page);
      window.location.hash = window.page;
      //$(this).addClass("active");

      page.show();

      var totop = setInterval(function () {
        $(".pages").animate({scrollTop: 0}, 0);
      }, 10);

      setTimeout(function () {
        page.addClass("active");
        setTimeout(function () {
          clearInterval(totop);
        }, 1000);
      }, 100);

      window.dispatchEvent(new Event('resize'));

    }


    $(".menu li").click(function () {

      toggle_page($(this).data("target"));

      // Menu
      if (!$(this).data("target")) return;
      if ($(this).is(".active")) return;
      $(".menu li").not($(this)).removeClass("active");
      $(this).addClass("active");

    });
  
    


    window.page = window.location.hash;
    if (window.page != "") {
      $(".menu").find("li[data-target=" + window.page + "]").trigger("click");
    }

    /* init material bootstrap js */
    $.material.init();
});
</script>




<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
